LifeOS Technical Architecture SpecificationVersion: 1.0.0Status: DRAFT (Pending Council Ratification)Date: 2025-10-26Classification: CONSTITUTIONAL ARTEFACT1. Architectural Philosophy: The "Kernel" ConceptLifeOS is not merely a collection of scripts; it is a Recursively Self-Improving (RSI) Operating System designed to manage entropy.The core architectural challenge is the conflict between Probabilistic Intelligence (LLMs, which are creative but hallucination-prone) and Deterministic Operations (Systems, which must be reliable and audit-proof).1.1 The Determinism InvariantLifeOS resolves this conflict through a strict separation of concerns:Cognition is Stochastic: We accept that agents (LLMs) are non-deterministic.Orchestration is Deterministic: We enforce that the process surrounding the agents (The Runtime) is immutable, replayable, and cryptographically verifiable.The Formula: Reliability = Stochastic Intelligence (Agents) + Durable Execution (Temporal) + Immutable Ledger (Git)2. System Topology: The Three PlanesThe architecture is divided into three concentric planes of existence. Data flows from high entropy (Ideation) to zero entropy (Constitution).Plane 1: The Constitution (Governance & Truth)Role: The single source of truth. Defines what the system is and how it must behave.Storage: Git Repository. No artifact exists unless committed to main.Core Components:llms.txt: Machine-readable index of all specs, optimized for agent context retrieval.manifest.lock: A SHA-256 Merkle tree of all frozen specifications.The Charter: Immutable prompt instructions defining the system's "Goal Alignment."Access Control: Read-Only for Agents. Write access is restricted to the StepGate (Human/Consensus).Plane 2: The Forge (Ideation & Development)Role: The workspace where agents "think," plan, and generate code. High entropy is permitted here.Tooling:Google Antigravity (IDE): The primary interface for "Mission" execution. Agents generate plans and code diffs here.NotebookLM: The "User Interface" for human operators to query and synthesize the system's state.Output: Agents in the Forge produce DAP Candidates (Draft Artifacts), never direct code.Plane 3: The Ledger (Runtime & Execution)Role: The nervous system. It orchestrates the flow of data between the Forge and the Constitution.Infrastructure:Temporal.io: The Durable Execution Engine. It guarantees that workflows (Debates, Tests, Deployments) run to completion, even if the host crashes or the wait time is weeks.LangGraph: Encapsulated logic for "Cognitive Cycles" (e.g., the debate loop between Architect and Skeptic).DeepEval: The "Intelligence Unit Test" suite.3. The Digital Artifact Protocol (DAP)To prevent "Vibe Coding," LifeOS rejects unstructured text. All agent outputs must conform to the DAP Schema. An agent does not "write code"; it "proposes a DAP."3.1 DAP Structure (JSON Schema)JSON{
  "dap_version": "1.0",
  "id": "uuid-v4",
  "type": "spec_update | code_patch | architecture_decision",
  "metadata": {
    "author_agent": "gemini-1.5-pro",
    "timestamp": "2025-10-26T12:00:00Z",
    "context_hash": "sha256_of_input_context"
  },
  "content": {
    "summary": "Updates auth logic to comply with new security spec.",
    "plan": "1. Update verify_token()...",
    "changes": [
      {"file": "src/auth.py", "diff": "..."}
    ]
  },
  "validation": {
    "debate_transcript_id": "link_to_debate_log",
    "deepeval_score": 0.95,
    "security_scan": "PASS"
  },
  "signature": "stepgate_pending"
}
4. The Core Workflow: The "Constitutional Loop"This is the standard operating procedure for any change in LifeOS (Self-Improvement).Phase A: Detection & Planning (The Forge)Trigger: Human request or System Alert (e.g., "Dependency vulnerability detected").Agent Action (Antigravity): The "Architect Agent" reads llms.txt, analyzes the codebase, and formulates a plan.Artifact Generation: The Agent produces a DAP Candidate (JSON).Phase B: The Adversarial Debate (The Runtime)Orchestration (Temporal): A GovernanceWorkflow is triggered.Debate Logic (LangGraph):Node 1 (The Skeptic): Reads the DAP. Critiques it against docs/governance/security.md. "This introduces a race condition."Node 2 (The Architect): Refines the DAP based on critique.Node 3 (The Judge): Uses DeepEval to score the final DAP. If score < Threshold, loop back. If retries > Max, fail.Persistence: The entire debate transcript is logged to logs/debates/.Phase C: The StepGate (The Decision)Human-in-the-Loop: Temporal pauses the workflow. A notification is sent to the Operator.Review: Operator reviews the DAP Summary and Skeptic's Critique.Action: Operator signs the DAP (cryptographic signature) or rejects it.Phase D: Freeze & Merge (The Constitution)Execution: Upon signature, Temporal triggers the merge.Canonicalization: freeze.py runs. It recalculates the SHA-256 hash of the modified files and updates manifest.lock.Commit: The Runtime pushes the changes to Git main.5. Implementation RoadmapHorizon 1: The "Iron Skeleton" (Now - Month 1)Focus: Manual triggers, Scripted safeguards, Local Execution.Repository: Standardize on Git with llms.txt and .agent/ directory structure.Tooling:Cognition: LiteLLM (Python) to abstract model calls.Validation: freeze.py (Script) for integrity checks.Debate: debate.py (Script) running a linear Architect -> Skeptic loop.The Grind Relief: Use LlamaIndex locally to query your own docs instead of reading them.Horizon 2: The "Constitutional Cloud" (Month 2 - Month 6)Focus: Automation, Durability, Scalability.Runtime Migration: Port debate.py logic into Temporal Workflows.IDE: Fully adopt Google Antigravity for the "Forge" workspace.CI/CD: Integrate DeepEval into GitHub Actions to block PRs that fail "Intelligence Tests."Identity: Assign distinct IAM identities to agents.6. Security & Safety ProtocolsThe Kill Switch: A CANARY.md file exists in the root. If this file is deleted or modified to contain "STOP", all Temporal workers immediately cease processing triggers.Instrumental Convergence Protection: The "Skeptic" agent's system prompt is immutable and hard-coded to prioritize safety and reversibility over efficiency. It cannot be overwritten by the "Architect."Identity Isolation: The "Architect" agent (Builder) has no write access to the manifest.lock. Only the freeze.py process (privileged runner) can update the manifest.7. Open Decisions for CouncilModel Selection: Shall we designate Gemini 1.5 Pro as the "Architect" (Context Window strength) and Claude 3.5 Sonnet as the "Skeptic" (Logic/Reasoning strength)?Thresholds: What is the minimum DeepEval score (0.0 - 1.0) required to trigger a StepGate notification? (Recommendation: 0.85).