============================= test session starts =============================
platform win32 -- Python 3.12.6, pytest-8.3.4, pluggy-1.5.0 -- C:\Python312\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\cabra\Projects\LifeOS
configfile: pytest.ini
testpaths: runtime/tests, tests_doc, tests_recursive
plugins: anyio-4.7.0, asyncio-1.3.0, cov-6.2.1, mockito-0.0.4
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=function, asyncio_default_test_loop_scope=function
collecting ... collected 786 items

runtime/tests/test_agent_api.py::TestCanonicalJson::test_deterministic_output PASSED [  0%]
runtime/tests/test_agent_api.py::TestCanonicalJson::test_sorted_keys PASSED [  0%]
runtime/tests/test_agent_api.py::TestCanonicalJson::test_no_whitespace PASSED [  0%]
runtime/tests/test_agent_api.py::TestCanonicalJson::test_utf8_encoding PASSED [  0%]
runtime/tests/test_agent_api.py::TestCanonicalJson::test_preserves_array_order PASSED [  0%]
runtime/tests/test_agent_api.py::TestCanonicalJson::test_rejects_nan_fail_closed PASSED [  0%]
runtime/tests/test_agent_api.py::TestCanonicalJson::test_rejects_infinity_fail_closed PASSED [  0%]
runtime/tests/test_agent_api.py::TestDeterministicIds::test_run_id_deterministic_stability PASSED [  1%]
runtime/tests/test_agent_api.py::TestDeterministicIds::test_run_id_changes_with_different_inputs PASSED [  1%]
runtime/tests/test_agent_api.py::TestDeterministicIds::test_call_id_deterministic_stability PASSED [  1%]
runtime/tests/test_agent_api.py::TestDeterministicIds::test_call_id_changes_with_different_role PASSED [  1%]
runtime/tests/test_agent_api.py::TestHashChainLogging::test_genesis_constant PASSED [  1%]
runtime/tests/test_agent_api.py::TestHashChainLogging::test_first_entry_uses_genesis PASSED [  1%]
runtime/tests/test_agent_api.py::TestHashChainLogging::test_chain_integrity PASSED [  1%]
runtime/tests/test_agent_api.py::TestHashChainLogging::test_chain_detects_tampering PASSED [  1%]
runtime/tests/test_amu0_hash_chain.py::TestAMU0HashChain::test_append_creates_chain PASSED [  2%]
runtime/tests/test_amu0_hash_chain.py::TestAMU0HashChain::test_chain_verification_passes PASSED [  2%]
runtime/tests/test_amu0_hash_chain.py::TestAMU0HashChain::test_tampered_chain_fails PASSED [  2%]
runtime/tests/test_amu0_lineage.py::TestAMU0Lineage::test_create_baseline_duplicate_raises PASSED [  2%]
runtime/tests/test_amu0_lineage.py::TestAMU0Lineage::test_create_baseline_manifest_integrity PASSED [  2%]
runtime/tests/test_amu0_lineage.py::TestAMU0Lineage::test_create_baseline_missing_timestamp_raises PASSED [  2%]
runtime/tests/test_amu0_lineage.py::TestAMU0Lineage::test_create_baseline_single_file PASSED [  2%]
runtime/tests/test_amu0_lineage.py::TestAMU0Lineage::test_create_restore_deterministic PASSED [  2%]
runtime/tests/test_amu0_lineage.py::TestAMU0Lineage::test_list_baselines PASSED [  3%]
runtime/tests/test_amu0_lineage.py::TestAMU0Lineage::test_promote_nonexistent_raises PASSED [  3%]
runtime/tests/test_amu0_lineage.py::TestAMU0Lineage::test_promote_run PASSED [  3%]
runtime/tests/test_amu0_lineage.py::TestAMU0Lineage::test_restore_byte_identical PASSED [  3%]
runtime/tests/test_amu0_lineage.py::TestAMU0Lineage::test_restore_from_baseline PASSED [  3%]
runtime/tests/test_amu0_lineage.py::TestAMU0Lineage::test_restore_nonexistent_raises PASSED [  3%]
runtime/tests/test_amu0_lineage.py::TestAMU0Lineage::test_verify_corrupted_manifest_fails PASSED [  3%]
runtime/tests/test_amu0_lineage.py::TestAMU0Lineage::test_verify_nonexistent_fails PASSED [  3%]
runtime/tests/test_amu0_lineage.py::TestAMU0Lineage::test_verify_valid_baseline PASSED [  4%]
runtime/tests/test_api_boundary.py::test_api_boundary_enforcement PASSED [  4%]
runtime/tests/test_attestation_recording.py::TestAttestationRecording::test_attestation_captures_primitives PASSED [  4%]
runtime/tests/test_attestation_recording.py::TestAttestationRecording::test_attestation_dict_format PASSED [  4%]
runtime/tests/test_backpressure.py::test_compute_thresholds PASSED       [  4%]
runtime/tests/test_backpressure.py::test_backpressure_pause PASSED       [  4%]
runtime/tests/test_backpressure.py::test_backpressure_resume PASSED      [  4%]
runtime/tests/test_baseline_governance.py::TestBaselineMissing::test_raises_when_baseline_missing PASSED [  4%]
runtime/tests/test_baseline_governance.py::TestBaselineMissing::test_error_includes_expected_path PASSED [  5%]
runtime/tests/test_baseline_governance.py::TestBaselineMismatch::test_raises_when_file_hash_mismatch PASSED [  5%]
runtime/tests/test_baseline_governance.py::TestBaselineMismatch::test_raises_when_file_missing PASSED [  5%]
runtime/tests/test_baseline_governance.py::TestBaselineMismatch::test_error_includes_resolution_options PASSED [  5%]
runtime/tests/test_baseline_governance.py::TestBaselineMismatch::test_mismatch_error_contains_full_hashes PASSED [  5%]
runtime/tests/test_baseline_governance.py::TestBaselineValid::test_passes_when_all_hashes_match PASSED [  5%]
runtime/tests/test_budget_txn.py::test_budget_charge_success PASSED      [  5%]
runtime/tests/test_budget_txn.py::test_budget_charge_fail_mission_limit PASSED [  5%]
runtime/tests/test_budget_txn.py::test_budget_charge_repair_success PASSED [  6%]
runtime/tests/test_budget_txn.py::test_budget_charge_repair_fail_limit PASSED [  6%]
runtime/tests/test_budget_txn.py::test_budget_concurrent_access PASSED   [  6%]
runtime/tests/test_build_handoff_scripts.py::TestPackageContext::test_alias_resolution PASSED [  6%]
runtime/tests/test_build_handoff_scripts.py::TestPackageContext::test_caps_enforcement PASSED [  6%]
runtime/tests/test_build_handoff_scripts.py::TestPackageContext::test_packet_shape_architect PASSED [  6%]
runtime/tests/test_build_handoff_scripts.py::TestStewardBlocked::test_grouping_determinism PASSED [  6%]
runtime/tests/test_build_handoff_scripts.py::TestStewardBlocked::test_age_calculation PASSED [  6%]
runtime/tests/test_build_handoff_scripts.py::TestCheckReadiness::test_sha256_hash PASSED [  7%]
runtime/tests/test_build_handoff_scripts.py::TestCheckReadiness::test_success_path_emits_packet PASSED [  7%]
runtime/tests/test_build_handoff_scripts.py::TestCheckReadiness::test_failure_path_emits_packet PASSED [  7%]
runtime/tests/test_build_handoff_scripts.py::TestPackageContextP1::test_council_packet_protected_paths_policy_ref PASSED [  7%]
runtime/tests/test_build_handoff_scripts.py::TestPackageContextP1::test_council_packet_includes_role_prompts PASSED [  7%]
runtime/tests/test_build_handoff_scripts.py::TestPackageContextP1::test_council_packet_includes_procedure_refs PASSED [  7%]
runtime/tests/test_build_handoff_scripts.py::TestPackageContextP1::test_fail_closed_unknown_component PASSED [  7%]
runtime/tests/test_build_handoff_scripts.py::TestPackageContextP1::test_decision_questions_capped PASSED [  8%]
runtime/tests/test_build_handoff_scripts.py::TestProtectedArtefacts::test_gemini_in_protected_artefacts PASSED [  8%]
runtime/tests/test_build_handoff_scripts.py::TestStewardBlockedP3::test_deterministic_ordering_by_created_at PASSED [  8%]
runtime/tests/test_build_handoff_scripts.py::TestStewardBlockedP3::test_deterministic_ordering_same_date_by_path PASSED [  8%]
runtime/tests/test_build_handoff_scripts.py::TestForwardSlashRefs::test_normalize_repo_path PASSED [  8%]
runtime/tests/test_build_handoff_scripts.py::TestForwardSlashRefs::test_council_packet_refs_use_forward_slashes PASSED [  8%]
runtime/tests/test_build_handoff_scripts.py::TestCT3TriggerDecision::test_council_packet_includes_ct3_trigger PASSED [  8%]
runtime/tests/test_build_handoff_scripts.py::TestCT3TriggerDecision::test_ct3_has_rationale PASSED [  8%]
runtime/tests/test_compatibility_matrix.py::test_interface_version_constant PASSED [  9%]
runtime/tests/test_compatibility_matrix.py::test_schema_version_fixture_v1 PASSED [  9%]
runtime/tests/test_compatibility_matrix.py::test_deprecation_warning_emission PASSED [  9%]
runtime/tests/test_compatibility_matrix.py::test_scenario_result_fixture_v1 PASSED [  9%]
runtime/tests/test_dap_gateway.py::TestDAPWriteGateway::test_generate_versioned_name PASSED [  9%]
runtime/tests/test_dap_gateway.py::TestDAPWriteGateway::test_is_in_boundary PASSED [  9%]
runtime/tests/test_dap_gateway.py::TestDAPWriteGateway::test_is_protected PASSED [  9%]
runtime/tests/test_dap_gateway.py::TestDAPWriteGateway::test_pending_index_updates PASSED [  9%]
runtime/tests/test_dap_gateway.py::TestDAPWriteGateway::test_validate_without_write PASSED [ 10%]
runtime/tests/test_dap_gateway.py::TestDAPWriteGateway::test_write_binary PASSED [ 10%]
runtime/tests/test_dap_gateway.py::TestDAPWriteGateway::test_write_in_allowed_root PASSED [ 10%]
runtime/tests/test_dap_gateway.py::TestDAPWriteGateway::test_write_outside_boundary_raises PASSED [ 10%]
runtime/tests/test_dap_gateway.py::TestDAPWriteGateway::test_write_to_protected_raises PASSED [ 10%]
runtime/tests/test_dap_gateway.py::TestIndexReconciler::test_generate_index_content PASSED [ 10%]
runtime/tests/test_dap_gateway.py::TestIndexReconciler::test_reconcile_creates_index PASSED [ 10%]
runtime/tests/test_dap_gateway.py::TestIndexReconciler::test_reconcile_no_change PASSED [ 10%]
runtime/tests/test_dap_gateway.py::TestIndexReconciler::test_scan_directory PASSED [ 11%]
runtime/tests/test_dap_gateway.py::TestIndexReconciler::test_verify_coherence_missing PASSED [ 11%]
runtime/tests/test_dap_gateway.py::TestIndexReconciler::test_verify_coherence_pass PASSED [ 11%]
runtime/tests/test_demo_approval_determinism.py::test_demo_approval_determinism PASSED [ 11%]
runtime/tests/test_determinism_suite.py::TestDeterminismSuite::test_amu0_timestamp_required PASSED [ 11%]
runtime/tests/test_determinism_suite.py::TestDeterminismSuite::test_checkpoint_content_deterministic PASSED [ 11%]
runtime/tests/test_determinism_suite.py::TestDeterminismSuite::test_checkpoint_no_timestamp_deterministic PASSED [ 11%]
runtime/tests/test_determinism_suite.py::TestDeterminismSuite::test_determinism_artifact_generation PASSED [ 11%]
runtime/tests/test_determinism_suite.py::TestDeterminismSuite::test_fsm_error_message_deterministic PASSED [ 12%]
runtime/tests/test_determinism_suite.py::TestDeterminismSuite::test_fsm_state_sequence_deterministic PASSED [ 12%]
runtime/tests/test_determinism_suite.py::TestDeterminismSuite::test_no_time_dependency_in_state PASSED [ 12%]
runtime/tests/test_determinism_suite.py::TestDeterminismSuite::test_strict_mode_deterministic_from_param PASSED [ 12%]
runtime/tests/test_deterministic_gateway.py::TestDeterministicGateway::test_call_returns_stub PASSED [ 12%]
runtime/tests/test_deterministic_gateway.py::TestDeterministicGateway::test_invalid_kind_rejected PASSED [ 12%]
runtime/tests/test_deterministic_gateway.py::TestDeterministicGateway::test_ledger_logging PASSED [ 12%]
runtime/tests/test_deterministic_gateway.py::TestDeterministicGateway::test_non_serializable_args_rejected PASSED [ 12%]
runtime/tests/test_deterministic_gateway.py::TestDeterministicGateway::test_valid_spec_accepted PASSED [ 13%]
runtime/tests/test_detsort_consistency.py::TestDetsortConsistency::test_detsort_dict_stable PASSED [ 13%]
runtime/tests/test_detsort_consistency.py::TestDetsortConsistency::test_detsort_list_stable PASSED [ 13%]
runtime/tests/test_detsort_consistency.py::TestDetsortConsistency::test_detsort_paths_normalizes PASSED [ 13%]
runtime/tests/test_detsort_consistency.py::TestDetsortConsistency::test_detsort_set_deterministic PASSED [ 13%]
runtime/tests/test_enforce_governance.py::TestEnforceGovernance::test_valid_digest PASSED [ 13%]
runtime/tests/test_enforce_governance.py::TestEnforceGovernance::test_placeholder_digest_failure PASSED [ 13%]
runtime/tests/test_enforce_governance.py::TestEnforceGovernance::test_invalid_digest_failure PASSED [ 13%]
runtime/tests/test_enforce_governance.py::TestEnforceGovernance::test_windows_prod_failure PASSED [ 14%]
runtime/tests/test_enforce_governance.py::TestEnforceGovernance::test_windows_dev_success PASSED [ 14%]
runtime/tests/test_enforce_governance.py::TestEnforceGovernance::test_empty_digest_failure PASSED [ 14%]
runtime/tests/test_enforce_governance.py::TestEnforceGovernance::test_malformed_digest_failure PASSED [ 14%]
runtime/tests/test_enforce_governance.py::TestValidateManifestPathContract::test_valid_paths PASSED [ 14%]
runtime/tests/test_enforce_governance.py::TestValidateManifestPathContract::test_backslash_failure PASSED [ 14%]
runtime/tests/test_enforce_governance.py::TestValidateManifestPathContract::test_parent_traversal_failure PASSED [ 14%]
runtime/tests/test_enforce_governance.py::TestValidateManifestPathContract::test_absolute_path_failure PASSED [ 15%]
runtime/tests/test_enforce_governance.py::TestValidateManifestPathContract::test_invalid_chars_failure PASSED [ 15%]
runtime/tests/test_engine.py::test_fsm_determinism PASSED                [ 15%]
runtime/tests/test_engine.py::test_fsm_invalid_transition PASSED         [ 15%]
runtime/tests/test_engine.py::test_fp001_strict_mode_explicit_true PASSED [ 15%]
runtime/tests/test_engine.py::test_fp001_strict_mode_explicit_false PASSED [ 15%]
runtime/tests/test_engine.py::test_fp001_strict_mode_from_env PASSED     [ 15%]
runtime/tests/test_engine.py::test_fp001_force_error_raises_governance_error PASSED [ 15%]
runtime/tests/test_engine.py::test_fp001_validate_history_valid PASSED   [ 16%]
runtime/tests/test_engine.py::test_fp001_validate_history_invalid PASSED [ 16%]
runtime/tests/test_engine.py::test_h002_checkpoint_round_trip PASSED     [ 16%]
runtime/tests/test_envelope_enforcer.py::TestPathContainment::test_path_within_repo_allowed PASSED [ 16%]
runtime/tests/test_envelope_enforcer.py::TestPathContainment::test_traversal_attempt_rejected PASSED [ 16%]
runtime/tests/test_envelope_enforcer.py::TestPathContainment::test_absolute_path_outside_repo_rejected PASSED [ 16%]
runtime/tests/test_envelope_enforcer.py::TestSymlinkRejection::test_symlink_rejected_when_enabled SKIPPED [ 16%]
runtime/tests/test_envelope_enforcer.py::TestSymlinkRejection::test_symlink_allowed_when_disabled SKIPPED [ 16%]
runtime/tests/test_envelope_enforcer.py::TestSymlinkRejection::test_check_symlink_safety PASSED [ 17%]
runtime/tests/test_envelope_enforcer.py::TestDenylist::test_denylisted_path_rejected PASSED [ 17%]
runtime/tests/test_envelope_enforcer.py::TestDenylist::test_denylist_takes_precedence PASSED [ 17%]
runtime/tests/test_envelope_enforcer.py::TestAllowlist::test_path_not_matching_allowlist_rejected PASSED [ 17%]
runtime/tests/test_envelope_enforcer.py::TestAllowlist::test_glob_star_matches_single_level PASSED [ 17%]
runtime/tests/test_envelope_enforcer.py::TestAllowlist::test_glob_doublestar_matches_nested PASSED [ 17%]
runtime/tests/test_envelope_enforcer.py::TestValidatePathAccessFunction::test_validate_path_access_function PASSED [ 17%]
runtime/tests/test_envelope_network_block.py::TestEnvelopeNetworkBlock::test_envelope_network_status PASSED [ 17%]
runtime/tests/test_envelope_network_block.py::TestEnvelopeNetworkBlock::test_network_module_detection PASSED [ 18%]
runtime/tests/test_envelope_single_process.py::TestEnvelopeSingleProcess::test_banned_module_detection PASSED [ 18%]
runtime/tests/test_envelope_single_process.py::TestEnvelopeSingleProcess::test_envelope_status_reports_failure PASSED [ 18%]
runtime/tests/test_freeze_sign.py::test_sign_verify_round_trip PASSED    [ 18%]
runtime/tests/test_freeze_sign.py::test_sign_determinism PASSED          [ 18%]
runtime/tests/test_fsm.py::test_start_task_execution PASSED              [ 18%]
runtime/tests/test_fsm.py::test_transition_to_failed_terminal PASSED     [ 18%]
runtime/tests/test_fsm_transitions.py::TestFSMTransitions::test_error_message_format PASSED [ 18%]
runtime/tests/test_fsm_transitions.py::TestFSMTransitions::test_error_state_is_terminal PASSED [ 19%]
runtime/tests/test_fsm_transitions.py::TestFSMTransitions::test_illegal_amendment_exec_to_init PASSED [ 19%]
runtime/tests/test_fsm_transitions.py::TestFSMTransitions::test_illegal_amendment_prep_to_complete PASSED [ 19%]
runtime/tests/test_fsm_transitions.py::TestFSMTransitions::test_illegal_init_to_complete PASSED [ 19%]
runtime/tests/test_fsm_transitions.py::TestFSMTransitions::test_illegal_init_to_freeze_activated PASSED [ 19%]
runtime/tests/test_fsm_transitions.py::TestFSMTransitions::test_illegal_init_to_gates PASSED [ 19%]
runtime/tests/test_fsm_transitions.py::TestFSMTransitions::test_illegal_skip_amendment_exec PASSED [ 19%]
runtime/tests/test_fsm_transitions.py::TestFSMTransitions::test_illegal_skip_ceo_review PASSED [ 19%]
runtime/tests/test_fsm_transitions.py::TestFSMTransitions::test_legal_amendment_exec_to_verify PASSED [ 20%]
runtime/tests/test_fsm_transitions.py::TestFSMTransitions::test_legal_amendment_prep_to_exec PASSED [ 20%]
runtime/tests/test_fsm_transitions.py::TestFSMTransitions::test_legal_amendment_verify_to_ceo_review PASSED [ 20%]
runtime/tests/test_fsm_transitions.py::TestFSMTransitions::test_legal_capture_to_migration PASSED [ 20%]
runtime/tests/test_fsm_transitions.py::TestFSMTransitions::test_legal_ceo_final_to_complete PASSED [ 20%]
runtime/tests/test_fsm_transitions.py::TestFSMTransitions::test_legal_ceo_review_to_freeze_prep PASSED [ 20%]
runtime/tests/test_fsm_transitions.py::TestFSMTransitions::test_legal_freeze_activated_to_capture PASSED [ 20%]
runtime/tests/test_fsm_transitions.py::TestFSMTransitions::test_legal_freeze_prep_to_activated PASSED [ 20%]
runtime/tests/test_fsm_transitions.py::TestFSMTransitions::test_legal_gates_to_ceo_final PASSED [ 21%]
runtime/tests/test_fsm_transitions.py::TestFSMTransitions::test_legal_init_to_amendment_prep PASSED [ 21%]
runtime/tests/test_fsm_transitions.py::TestFSMTransitions::test_legal_migration_to_gates PASSED [ 21%]
runtime/tests/test_governance_override_protected_surface.py::TestGovernanceOverrideProtocol::test_apply_with_council_key_succeeds PASSED [ 21%]
runtime/tests/test_governance_override_protected_surface.py::TestGovernanceOverrideProtocol::test_apply_without_council_key_fails PASSED [ 21%]
runtime/tests/test_governance_override_protected_surface.py::TestGovernanceOverrideProtocol::test_prepare_request_no_write PASSED [ 21%]
runtime/tests/test_governance_protection.py::TestGovernanceProtector::test_add_protected_path PASSED [ 21%]
runtime/tests/test_governance_protection.py::TestGovernanceProtector::test_get_protected_paths PASSED [ 22%]
runtime/tests/test_governance_protection.py::TestGovernanceProtector::test_init_without_registry PASSED [ 22%]
runtime/tests/test_governance_protection.py::TestGovernanceProtector::test_is_not_protected PASSED [ 22%]
runtime/tests/test_governance_protection.py::TestGovernanceProtector::test_is_protected_exact_match PASSED [ 22%]
runtime/tests/test_governance_protection.py::TestGovernanceProtector::test_is_protected_subdirectory PASSED [ 22%]
runtime/tests/test_governance_protection.py::TestGovernanceProtector::test_remove_protected_path PASSED [ 22%]
runtime/tests/test_governance_protection.py::TestGovernanceProtector::test_save_registry PASSED [ 22%]
runtime/tests/test_governance_protection.py::TestGovernanceProtector::test_validate_mission_scope_exceeds_ceiling PASSED [ 22%]
runtime/tests/test_governance_protection.py::TestGovernanceProtector::test_validate_mission_scope_valid PASSED [ 23%]
runtime/tests/test_governance_protection.py::TestGovernanceProtector::test_validate_scope_exceeds_directories PASSED [ 23%]
runtime/tests/test_governance_protection.py::TestGovernanceProtector::test_validate_scope_exceeds_files PASSED [ 23%]
runtime/tests/test_governance_protection.py::TestGovernanceProtector::test_validate_scope_or_raise PASSED [ 23%]
runtime/tests/test_governance_protection.py::TestGovernanceProtector::test_validate_scope_protected_violations PASSED [ 23%]
runtime/tests/test_governance_protection.py::TestGovernanceProtector::test_validate_scope_within_ceiling PASSED [ 23%]
runtime/tests/test_governance_protection.py::TestGovernanceProtector::test_validate_write_allowed PASSED [ 23%]
runtime/tests/test_governance_protection.py::TestGovernanceProtector::test_validate_write_protected_raises PASSED [ 23%]
runtime/tests/test_governance_surface_immutable.py::TestGovernanceSurfaceImmutable::test_missing_surface_fails PASSED [ 24%]
runtime/tests/test_governance_surface_immutable.py::TestGovernanceSurfaceImmutable::test_valid_surfaces_pass PASSED [ 24%]
runtime/tests/test_index_atomic_write.py::TestIndexAtomicWrite::test_atomic_write_creates_file PASSED [ 24%]
runtime/tests/test_index_atomic_write.py::TestIndexAtomicWrite::test_atomic_write_json PASSED [ 24%]
runtime/tests/test_index_atomic_write.py::TestIndexAtomicWrite::test_index_updater_atomic PASSED [ 24%]
runtime/tests/test_invariants.py::test_invariant_success PASSED          [ 24%]
runtime/tests/test_invariants.py::test_invariant_failure PASSED          [ 24%]
runtime/tests/test_llm_call_operation.py::TestLLMCallStoresResult::test_llm_call_stores_result_in_state PASSED [ 24%]
runtime/tests/test_llm_call_operation.py::TestLLMCallStoresResult::test_llm_call_default_output_key PASSED [ 25%]
runtime/tests/test_llm_call_operation.py::TestLLMCallValidation::test_llm_call_with_missing_prompt_fails PASSED [ 25%]
runtime/tests/test_llm_call_operation.py::TestLLMCallValidation::test_llm_call_with_empty_prompt_fails PASSED [ 25%]
runtime/tests/test_llm_call_operation.py::TestLLMCallCustomOutputKey::test_llm_call_with_custom_output_key PASSED [ 25%]
runtime/tests/test_llm_call_operation.py::TestLLMCallCustomOutputKey::test_multiple_llm_calls_different_keys PASSED [ 25%]
runtime/tests/test_llm_call_operation.py::TestMixedOperationWorkflows::test_workflow_with_mixed_operations PASSED [ 25%]
runtime/tests/test_llm_call_operation.py::TestMixedOperationWorkflows::test_noop_before_llm_call PASSED [ 25%]
runtime/tests/test_llm_call_operation.py::TestLLMCallErrorHandling::test_llm_call_client_error PASSED [ 25%]
runtime/tests/test_llm_call_operation.py::TestLLMCallErrorHandling::test_llm_call_unexpected_error PASSED [ 26%]
runtime/tests/test_llm_call_operation.py::TestClientLifecycle::test_client_started_only_on_llm_call PASSED [ 26%]
runtime/tests/test_llm_call_operation.py::TestClientLifecycle::test_client_stopped_after_workflow PASSED [ 26%]
runtime/tests/test_llm_call_operation.py::TestClientLifecycle::test_client_reused_for_multiple_calls PASSED [ 26%]
runtime/tests/test_llm_call_operation.py::TestLLMCallCustomModel::test_llm_call_with_custom_model PASSED [ 26%]
runtime/tests/test_manifest_parsing.py::test_missing_manifest PASSED     [ 26%]
runtime/tests/test_manifest_parsing.py::test_incomplete_write PASSED     [ 26%]
runtime/tests/test_manifest_parsing.py::test_invalid_json PASSED         [ 26%]
runtime/tests/test_manifest_parsing.py::test_malformed_checksum PASSED   [ 27%]
runtime/tests/test_manifest_parsing.py::test_checksum_mismatch PASSED    [ 27%]
runtime/tests/test_manifest_parsing.py::test_path_special_chars PASSED   [ 27%]
runtime/tests/test_manifest_parsing.py::test_valid_paths_with_spaces PASSED [ 27%]
runtime/tests/test_manifest_parsing.py::test_checksum_line_ending_normalization PASSED [ 27%]
runtime/tests/test_mission_journal.py::TestMissionJournal::test_genesis_constant PASSED [ 27%]
runtime/tests/test_mission_journal.py::TestMissionJournal::test_first_entry_uses_genesis PASSED [ 27%]
runtime/tests/test_mission_journal.py::TestMissionJournal::test_chain_links_entries PASSED [ 27%]
runtime/tests/test_mission_journal.py::TestMissionJournal::test_chain_root_is_last_hash PASSED [ 28%]
runtime/tests/test_mission_journal.py::TestMissionJournal::test_verify_integrity_passes_intact_chain PASSED [ 28%]
runtime/tests/test_mission_journal.py::TestMissionJournal::test_verify_integrity_detects_tampering PASSED [ 28%]
runtime/tests/test_mission_journal.py::TestMissionJournal::test_record_operation_stores_receipt PASSED [ 28%]
runtime/tests/test_mission_journal.py::TestJournalExport::test_export_bundle_structure PASSED [ 28%]
runtime/tests/test_mission_journal.py::TestJournalExport::test_export_is_json_serializable PASSED [ 28%]
runtime/tests/test_mission_journal.py::TestDeterminism::test_stable_hash_for_same_content PASSED [ 28%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle1PublicAPI::test_public_api_imports PASSED [ 29%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle1PublicAPI::test_version_exists_and_is_semver PASSED [ 29%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle1PublicAPI::test_version_constant_is_exported PASSED [ 29%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle2SchemaConformance::test_mission_id_structure PASSED [ 29%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle2SchemaConformance::test_mission_definition_structure PASSED [ 29%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle2SchemaConformance::test_mission_definition_defaults PASSED [ 29%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle2SchemaConformance::test_mission_registry_state_structure PASSED [ 29%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle3CanonicalJSON::test_canonical_json_is_stable PASSED [ 29%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle3CanonicalJSON::test_canonical_json_settings_are_pinned PASSED [ 30%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle3CanonicalJSON::test_canonical_json_roundtrip PASSED [ 30%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle4HashStability::test_state_hash_is_stable PASSED [ 30%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle4HashStability::test_different_states_different_hashes PASSED [ 30%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle5ValidationBoundaries::test_validate_mission_id_rejects_empty PASSED [ 30%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle5ValidationBoundaries::test_validate_mission_id_rejects_whitespace_only PASSED [ 30%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle5ValidationBoundaries::test_validate_definition_rejects_empty_name PASSED [ 30%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle5ValidationBoundaries::test_validate_definition_rejects_overlong_name PASSED [ 30%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle5ValidationBoundaries::test_validate_definition_rejects_overlong_description PASSED [ 31%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle5ValidationBoundaries::test_validate_definition_rejects_too_many_tags PASSED [ 31%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle5ValidationBoundaries::test_validate_definition_rejects_overlong_tag PASSED [ 31%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle6Immutability::test_mission_id_is_frozen PASSED [ 31%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle6Immutability::test_mission_definition_is_frozen PASSED [ 31%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle6Immutability::test_registry_operations_return_new_instances PASSED [ 31%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle7MetadataCanonicalOrdering::test_metadata_permutations_produce_same_canonical_json PASSED [ 31%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle8TagOrderPolicy::test_different_tag_orders_produce_different_hashes PASSED [ 31%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle8TagOrderPolicy::test_same_tag_order_produces_same_hash PASSED [ 32%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle9RegistryOperations::test_registry_enforces_id_length_boundary_on_register PASSED [ 32%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle9RegistryOperations::test_registry_enforces_boundaries_on_update PASSED [ 32%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle9RegistryOperations::test_remove_raises_on_missing_id PASSED [ 32%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle9RegistryOperations::test_metadata_serialization_check PASSED [ 32%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle10ChairConditions::test_registry_enforces_capacity_limit PASSED [ 32%]
runtime/tests/test_mission_registry/test_mission_registry_v0_1.py::TestCycle10ChairConditions::test_metadata_enforces_size_limits PASSED [ 32%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle1V02PublicAPI::test_synthesis_request_is_exported PASSED [ 32%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle1V02PublicAPI::test_synthesize_mission_is_exported PASSED [ 33%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle1V02PublicAPI::test_validate_mission_definition_v02_is_exported PASSED [ 33%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle1V02PublicAPI::test_ambiguous_validate_names_are_not_exported PASSED [ 33%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle2SynthesisRequestSchema::test_synthesis_request_has_required_fields PASSED [ 33%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle2SynthesisRequestSchema::test_synthesis_request_defaults PASSED [ 33%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle2SynthesisRequestSchema::test_synthesis_request_is_frozen PASSED [ 33%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle3DeterministicSynthesis::test_synthesis_produces_mission_definition PASSED [ 33%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle3DeterministicSynthesis::test_synthesis_is_deterministic PASSED [ 33%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle3DeterministicSynthesis::test_synthesis_canonical_json_is_stable PASSED [ 34%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle3DeterministicSynthesis::test_synthesis_metadata_sorted_by_key PASSED [ 34%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle4InvariantValidation::test_rejects_empty_id PASSED [ 34%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle4InvariantValidation::test_rejects_whitespace_only_id PASSED [ 34%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle4InvariantValidation::test_rejects_overlong_id PASSED [ 34%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle4InvariantValidation::test_rejects_empty_name PASSED [ 34%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle4InvariantValidation::test_rejects_overlong_name PASSED [ 34%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle4InvariantValidation::test_rejects_invalid_metadata_type PASSED [ 34%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle4InvariantValidation::test_rejects_too_many_tags PASSED [ 35%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle5ValidateEntrypoint::test_validate_accepts_valid_definition PASSED [ 35%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle5ValidateEntrypoint::test_validate_rejects_invalid_definition PASSED [ 35%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle5ValidateEntrypoint::test_validate_accepts_custom_config PASSED [ 35%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle6ErrorTaxonomy::test_error_messages_are_stable PASSED [ 35%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle6ErrorTaxonomy::test_all_validation_errors_are_boundary_violations PASSED [ 35%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle7GoldenFixture::test_golden_fixture_synthesis PASSED [ 35%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle7GoldenFixture::test_golden_fixture_hash_stability PASSED [ 36%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle8ContractDecisions::test_decision_tags_are_order_significant PASSED [ 36%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle8ContractDecisions::test_decision_whitespace_is_rejected_without_stripping PASSED [ 36%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle9Hygiene::test_proof_id_whitespace_only_is_rejected PASSED [ 36%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle9Hygiene::test_proof_tags_cannot_be_empty_or_whitespace PASSED [ 36%]
runtime/tests/test_mission_registry/test_mission_registry_v0_2.py::TestCycle9Hygiene::test_proof_metadata_keys_cannot_be_empty_or_whitespace PASSED [ 36%]
runtime/tests/test_mission_registry/test_tier3_mission_registry_contracts.py::TestAT2InterfaceDefinedNoExecution::test_at1_public_interface_surface PASSED [ 36%]
runtime/tests/test_mission_registry/test_tier3_mission_registry_contracts.py::TestAT2InterfaceDefinedNoExecution::test_registry_operations_are_pure PASSED [ 36%]
runtime/tests/test_mission_registry/test_tier3_mission_registry_contracts.py::TestAT2InterfaceDefinedNoExecution::test_validation_enforced_on_register PASSED [ 37%]
runtime/tests/test_mission_registry/test_tier3_mission_registry_contracts.py::TestAT2InterfaceDefinedNoExecution::test_conflict_error_on_duplicate PASSED [ 37%]
runtime/tests/test_mission_registry/test_tier3_mission_registry_contracts.py::TestAT2InterfaceDefinedNoExecution::test_not_found_error_on_missing PASSED [ 37%]
runtime/tests/test_mission_registry/test_tier3_mission_registry_contracts.py::TestAT2InterfaceDefinedNoExecution::test_no_io_during_operations PASSED [ 37%]
runtime/tests/test_mission_registry/test_tier3_mission_registry_contracts.py::TestAT3DeterminismStability::test_different_insertion_orders_same_canonical_json PASSED [ 37%]
runtime/tests/test_mission_registry/test_tier3_mission_registry_contracts.py::TestAT3DeterminismStability::test_determinism_with_metadata_variations PASSED [ 37%]
runtime/tests/test_mission_registry/test_tier3_mission_registry_contracts.py::TestAT3DeterminismStability::test_empty_registry_is_deterministic PASSED [ 37%]
runtime/tests/test_missions_phase3.py::TestMissionType::test_all_types_defined PASSED [ 37%]
runtime/tests/test_missions_phase3.py::TestMissionType::test_string_enum PASSED [ 38%]
runtime/tests/test_missions_phase3.py::TestMissionRegistry::test_contains_all_mission_types PASSED [ 38%]
runtime/tests/test_missions_phase3.py::TestMissionRegistry::test_get_mission_class_valid PASSED [ 38%]
runtime/tests/test_missions_phase3.py::TestMissionRegistry::test_get_mission_class_unknown_fails_closed PASSED [ 38%]
runtime/tests/test_missions_phase3.py::TestMissionRegistry::test_run_mission_unknown_fails_closed PASSED [ 38%]
runtime/tests/test_missions_phase3.py::TestMissionRegistry::test_list_mission_types_deterministic PASSED [ 38%]
runtime/tests/test_missions_phase3.py::TestSchemaValidation::test_load_schema_succeeds PASSED [ 38%]
runtime/tests/test_missions_phase3.py::TestSchemaValidation::test_valid_definition_passes PASSED [ 38%]
runtime/tests/test_missions_phase3.py::TestSchemaValidation::test_missing_required_field_fails PASSED [ 39%]
runtime/tests/test_missions_phase3.py::TestSchemaValidation::test_invalid_type_enum_fails PASSED [ 39%]
runtime/tests/test_missions_phase3.py::TestSchemaValidation::test_error_messages_sorted PASSED [ 39%]
runtime/tests/test_missions_phase3.py::TestDesignMission::test_mission_type PASSED [ 39%]
runtime/tests/test_missions_phase3.py::TestDesignMission::test_valid_inputs_pass PASSED [ 39%]
runtime/tests/test_missions_phase3.py::TestDesignMission::test_missing_task_spec_fails PASSED [ 39%]
runtime/tests/test_missions_phase3.py::TestDesignMission::test_run_succeeds PASSED [ 39%]
runtime/tests/test_missions_phase3.py::TestDesignMission::test_run_with_context_refs PASSED [ 39%]
runtime/tests/test_missions_phase3.py::TestReviewMission::test_mission_type PASSED [ 40%]
runtime/tests/test_missions_phase3.py::TestReviewMission::test_valid_inputs_pass PASSED [ 40%]
runtime/tests/test_missions_phase3.py::TestReviewMission::test_missing_subject_packet_fails PASSED [ 40%]
runtime/tests/test_missions_phase3.py::TestReviewMission::test_invalid_review_type_fails PASSED [ 40%]
runtime/tests/test_missions_phase3.py::TestReviewMission::test_run_succeeds PASSED [ 40%]
runtime/tests/test_missions_phase3.py::TestBuildMission::test_mission_type PASSED [ 40%]
runtime/tests/test_missions_phase3.py::TestBuildMission::test_valid_inputs_pass PASSED [ 40%]
runtime/tests/test_missions_phase3.py::TestBuildMission::test_unapproved_fails PASSED [ 40%]
runtime/tests/test_missions_phase3.py::TestBuildMission::test_run_succeeds PASSED [ 41%]
runtime/tests/test_missions_phase3.py::TestStewardMission::test_mission_type PASSED [ 41%]
runtime/tests/test_missions_phase3.py::TestStewardMission::test_valid_inputs_pass PASSED [ 41%]
runtime/tests/test_missions_phase3.py::TestStewardMission::test_unapproved_fails PASSED [ 41%]
runtime/tests/test_missions_phase3.py::TestStewardMission::test_run_succeeds PASSED [ 41%]
runtime/tests/test_missions_phase3.py::TestAutonomousBuildCycleMission::test_mission_type PASSED [ 41%]
runtime/tests/test_missions_phase3.py::TestAutonomousBuildCycleMission::test_valid_inputs_pass PASSED [ 41%]
runtime/tests/test_missions_phase3.py::TestAutonomousBuildCycleMission::test_run_composes_correctly PASSED [ 41%]
runtime/tests/test_missions_phase3.py::TestAutonomousBuildCycleMission::test_run_full_cycle_success PASSED [ 42%]
runtime/tests/test_missions_phase3.py::TestMissionResultSerialization::test_to_dict_deterministic PASSED [ 42%]
runtime/tests/test_missions_phase3.py::TestMissionResultSerialization::test_to_dict_consistent PASSED [ 42%]
runtime/tests/test_missions_phase3.py::TestEngineMissionDispatch::test_design_mission_via_registry PASSED [ 42%]
runtime/tests/test_missions_phase3.py::TestEngineMissionDispatch::test_unknown_mission_fails_closed PASSED [ 42%]
runtime/tests/test_opencode_client.py::TestLLMCall::test_llm_call_default_model FAILED [ 42%]
runtime/tests/test_opencode_client.py::TestLLMCall::test_llm_call_custom_model PASSED [ 42%]
runtime/tests/test_opencode_client.py::TestLLMCall::test_llm_call_empty_prompt PASSED [ 43%]
runtime/tests/test_opencode_client.py::TestLLMResponse::test_llm_response_creation PASSED [ 43%]
runtime/tests/test_opencode_client.py::TestLLMResponse::test_llm_response_empty_content PASSED [ 43%]
runtime/tests/test_opencode_client.py::TestExceptions::test_opencode_error_exists PASSED [ 43%]
runtime/tests/test_opencode_client.py::TestExceptions::test_opencode_server_error_inherits PASSED [ 43%]
runtime/tests/test_opencode_client.py::TestExceptions::test_opencode_timeout_error_inherits PASSED [ 43%]
runtime/tests/test_opencode_client.py::TestExceptions::test_opencode_session_error_inherits PASSED [ 43%]
runtime/tests/test_opencode_client.py::TestExceptions::test_exception_messages PASSED [ 43%]
runtime/tests/test_opencode_client.py::TestClientInstantiation::test_client_default_values PASSED [ 44%]
runtime/tests/test_opencode_client.py::TestClientInstantiation::test_client_custom_port PASSED [ 44%]
runtime/tests/test_opencode_client.py::TestClientInstantiation::test_client_custom_timeout PASSED [ 44%]
runtime/tests/test_opencode_client.py::TestClientInstantiation::test_client_disable_logging PASSED [ 44%]
runtime/tests/test_opencode_client.py::TestClientInstantiation::test_client_base_url PASSED [ 44%]
runtime/tests/test_opencode_client.py::TestClientInstantiation::test_client_not_running_by_default PASSED [ 44%]
runtime/tests/test_opencode_client.py::TestClientInstantiation::test_client_with_api_key PASSED [ 44%]
runtime/tests/test_opencode_client.py::TestLogDirectory::test_log_directory_created PASSED [ 44%]
runtime/tests/test_opencode_client.py::TestLogDirectory::test_log_directory_not_created_when_disabled PASSED [ 45%]
runtime/tests/test_opencode_client.py::TestServerState::test_call_without_server_raises FAILED [ 45%]
runtime/tests/test_opencode_client.py::TestServerState::test_start_without_api_key_raises PASSED [ 45%]
runtime/tests/test_opencode_client.py::TestServerState::test_start_when_already_running_raises PASSED [ 45%]
runtime/tests/test_opencode_client.py::TestImports::test_import_from_agents_package FAILED [ 45%]
runtime/tests/test_opencode_client.py::TestImports::test_all_exports FAILED [ 45%]
runtime/tests/test_opencode_client.py::TestDeterminism::test_llm_call_equality PASSED [ 45%]
runtime/tests/test_opencode_client.py::TestDeterminism::test_llm_response_equality PASSED [ 45%]
runtime/tests/test_opencode_governance/test_phase1_contract.py::test_t1_service_boots_smoke PASSED [ 46%]
runtime/tests/test_opencode_governance/test_phase1_contract.py::test_t2_rejects_missing_field PASSED [ 46%]
runtime/tests/test_opencode_governance/test_phase1_contract.py::test_t2_rejects_invalid_version PASSED [ 46%]
runtime/tests/test_opencode_governance/test_phase1_contract.py::test_t2_rejects_missing_payload PASSED [ 46%]
runtime/tests/test_opencode_governance/test_phase1_contract.py::test_t2_rejects_invalid_payload_type PASSED [ 46%]
runtime/tests/test_opencode_governance/test_phase1_contract.py::test_t2b_internal_error_guard PASSED [ 46%]
runtime/tests/test_opencode_governance/test_phase1_contract.py::test_t3_determinism PASSED [ 46%]
runtime/tests/test_opencode_governance/test_phase1_contract.py::test_t4_steward_opencode_validate PASSED [ 46%]
runtime/tests/test_opencode_governance/test_phase1_contract.py::test_t5_canonical_evidence_capture FAILED [ 47%]
runtime/tests/test_operations.py::TestCompensationType::test_none_type_accepts_empty_command PASSED [ 47%]
runtime/tests/test_operations.py::TestCompensationType::test_none_type_rejects_non_empty_command PASSED [ 47%]
runtime/tests/test_operations.py::TestCompensationType::test_custom_validated_accepts_whitelist_command PASSED [ 47%]
runtime/tests/test_operations.py::TestCompensationType::test_custom_validated_rejects_unknown_command PASSED [ 47%]
runtime/tests/test_operations.py::TestCompensationType::test_other_types_require_non_empty_command PASSED [ 47%]
runtime/tests/test_operations.py::TestStateHash::test_stable_hash_same_content PASSED [ 47%]
runtime/tests/test_operations.py::TestStateHash::test_different_content_different_hash PASSED [ 47%]
runtime/tests/test_operations.py::TestStateHash::test_missing_file_handled PASSED [ 48%]
runtime/tests/test_operations.py::TestStateHash::test_order_independent PASSED [ 48%]
runtime/tests/test_operations.py::TestCanonicalBytes::test_sorted_keys PASSED [ 48%]
runtime/tests/test_operations.py::TestCanonicalBytes::test_no_whitespace PASSED [ 48%]
runtime/tests/test_operations.py::TestCanonicalBytes::test_rejects_nan PASSED [ 48%]
runtime/tests/test_operations.py::TestCanonicalBytes::test_rejects_infinity PASSED [ 48%]
runtime/tests/test_operations.py::TestCanonicalBytes::test_deterministic PASSED [ 48%]
runtime/tests/test_operations.py::TestOperationExecutor::test_execute_returns_receipt PASSED [ 48%]
runtime/tests/test_operations.py::TestOperationExecutor::test_execute_validates_compensation PASSED [ 49%]
runtime/tests/test_operations.py::TestOperationExecutor::test_tool_invoke_checks_envelope PASSED [ 49%]
runtime/tests/test_packet_validation.py::test_missing_required_field PASSED [ 49%]
runtime/tests/test_packet_validation.py::test_council_review_missing_objective PASSED [ 49%]
runtime/tests/test_packet_validation.py::test_bundle_full_validate_fails_schema PASSED [ 49%]
runtime/tests/test_packet_validation.py::test_lineage_verification_pass PASSED [ 49%]
runtime/tests/test_packet_validation.py::test_lineage_verification_mismatch PASSED [ 49%]
runtime/tests/test_packet_validation.py::test_lineage_verification_missing_packet PASSED [ 50%]
runtime/tests/test_packet_validation.py::test_compression_fail PASSED    [ 50%]
runtime/tests/test_packet_validation.py::test_schema_validity PASSED     [ 50%]
runtime/tests/test_packet_validation.py::test_validator_uses_schema_override PASSED [ 50%]
runtime/tests/test_packet_validation.py::test_no_hardcoded_taxonomy PASSED [ 50%]
runtime/tests/test_packet_validation.py::test_ttl_expiry PASSED          [ 50%]
runtime/tests/test_packet_validation.py::test_replay_collision PASSED    [ 50%]
runtime/tests/test_packet_validation.py::test_signature_enforcement PASSED [ 50%]
runtime/tests/test_packet_validation.py::test_deprecated_gating PASSED   [ 51%]
runtime/tests/test_packet_validation.py::test_ignore_skew_override PASSED [ 51%]
runtime/tests/test_packet_validation.py::test_plan_build_packet_valid PASSED [ 51%]
runtime/tests/test_packet_validation.py::test_plan_review_packet_valid PASSED [ 51%]
runtime/tests/test_packet_validation.py::test_semver_incompatible PASSED [ 51%]
runtime/tests/test_packet_validation.py::test_schema_taxonomy_no_overlap PASSED [ 51%]
runtime/tests/test_packet_validation.py::test_deprecated_gate_enforced_even_if_core_overlap PASSED [ 51%]
runtime/tests/test_planner_validation.py::test_validate_required_artifact_ids_valid PASSED [ 51%]
runtime/tests/test_planner_validation.py::test_validate_required_artifact_ids_invalid_type PASSED [ 52%]
runtime/tests/test_planner_validation.py::test_validate_required_artifact_ids_limit_exceeded PASSED [ 52%]
runtime/tests/test_planner_validation.py::test_validate_plan_budget_valid PASSED [ 52%]
runtime/tests/test_planner_validation.py::test_validate_plan_budget_exceeded PASSED [ 52%]
runtime/tests/test_reactive/test_spec_conformance.py::TestCycle1PublicAPI::test_public_api_imports PASSED [ 52%]
runtime/tests/test_reactive/test_spec_conformance.py::TestCycle2SchemaConformance::test_plan_surface_schema_exact PASSED [ 52%]
runtime/tests/test_reactive/test_spec_conformance.py::TestCycle2SchemaConformance::test_constraints_default_matches_config PASSED [ 52%]
runtime/tests/test_reactive/test_spec_conformance.py::TestCycle2SchemaConformance::test_tags_none_emits_empty_list PASSED [ 52%]
runtime/tests/test_reactive/test_spec_conformance.py::TestCycle2SchemaConformance::test_tags_order_preserved PASSED [ 53%]
runtime/tests/test_reactive/test_spec_conformance.py::TestCycle3CanonicalJSON::test_canonical_json_is_stable PASSED [ 53%]
runtime/tests/test_reactive/test_spec_conformance.py::TestCycle3CanonicalJSON::test_canonical_json_settings_are_pinned PASSED [ 53%]
runtime/tests/test_reactive/test_spec_conformance.py::TestCycle3CanonicalJSON::test_canonical_json_roundtrip PASSED [ 53%]
runtime/tests/test_reactive/test_spec_conformance.py::TestCycle4HashStability::test_surface_hash_is_stable PASSED [ 53%]
runtime/tests/test_reactive/test_spec_conformance.py::TestCycle5ValidationBoundaries::test_validate_request_accepts_valid PASSED [ 53%]
runtime/tests/test_reactive/test_spec_conformance.py::TestCycle5ValidationBoundaries::test_validate_request_rejects_empty_id PASSED [ 53%]
runtime/tests/test_reactive/test_spec_conformance.py::TestCycle5ValidationBoundaries::test_validate_request_rejects_invalid_tags_type PASSED [ 53%]
runtime/tests/test_reactive/test_spec_conformance.py::TestCycle5ValidationBoundaries::test_validate_request_rejects_empty_title PASSED [ 54%]
runtime/tests/test_reactive/test_spec_conformance.py::TestCycle5ValidationBoundaries::test_validate_request_rejects_overlong_description PASSED [ 54%]
runtime/tests/test_reactive/test_spec_conformance.py::TestCycle5ValidationBoundaries::test_validate_request_rejects_too_many_tags PASSED [ 54%]
runtime/tests/test_reactive/test_spec_conformance.py::TestCycle5ValidationBoundaries::test_validate_request_rejects_overlong_tag PASSED [ 54%]
runtime/tests/test_reactive/test_spec_conformance.py::TestCycle5ValidationBoundaries::test_validate_surface_rejects_oversized_payload PASSED [ 54%]
runtime/tests/test_reactive/test_spec_conformance.py::TestCycle6Immutability::test_dataclasses_are_frozen PASSED [ 54%]
runtime/tests/test_reactive/test_spec_conformance.py::TestVersionConstant::test_version_constant_exists_and_is_string PASSED [ 54%]
runtime/tests/test_reactive/test_spec_conformance.py::TestVersionConstant::test_version_constant_matches_semantic_pattern PASSED [ 54%]
runtime/tests/test_reactive/test_spec_conformance.py::TestVersionConstant::test_surface_uses_version_constant PASSED [ 55%]
runtime/tests/test_reactive/test_spec_conformance.py::TestDeterminismHardening::test_dict_insertion_order_does_not_affect_canonical_json PASSED [ 55%]
runtime/tests/test_reactive/test_spec_conformance.py::TestDeterminismHardening::test_request_field_order_does_not_affect_surface PASSED [ 55%]
runtime/tests/test_reactive/test_spec_conformance.py::TestValidationEdgeCases::test_validate_request_at_exact_title_limit PASSED [ 55%]
runtime/tests/test_reactive/test_spec_conformance.py::TestValidationEdgeCases::test_validate_request_at_exact_description_limit PASSED [ 55%]
runtime/tests/test_reactive/test_spec_conformance.py::TestValidationEdgeCases::test_validate_request_at_exact_tags_limit PASSED [ 55%]
runtime/tests/test_reactive/test_spec_conformance.py::TestValidationEdgeCases::test_validate_request_at_exact_tag_char_limit PASSED [ 55%]
runtime/tests/test_reactive/test_spec_conformance.py::TestUnicodeCoverage::test_unicode_in_title_is_escaped PASSED [ 55%]
runtime/tests/test_reactive/test_spec_conformance.py::TestUnicodeCoverage::test_unicode_in_description_is_escaped PASSED [ 56%]
runtime/tests/test_reactive/test_spec_conformance.py::TestUnicodeCoverage::test_unicode_in_tags_is_escaped PASSED [ 56%]
runtime/tests/test_reactive/test_spec_conformance.py::TestBuildPlanSurface::test_build_plan_surface_is_importable PASSED [ 56%]
runtime/tests/test_reactive/test_spec_conformance.py::TestBuildPlanSurface::test_build_plan_surface_produces_valid_surface PASSED [ 56%]
runtime/tests/test_reactive/test_spec_conformance.py::TestBuildPlanSurface::test_build_plan_surface_rejects_invalid_request PASSED [ 56%]
runtime/tests/test_reactive/test_spec_conformance.py::TestBuildPlanSurface::test_build_plan_surface_rejects_oversized_payload PASSED [ 56%]
runtime/tests/test_reactive/test_spec_conformance.py::TestBuildPlanSurface::test_build_plan_surface_is_deterministic PASSED [ 56%]
runtime/tests/test_reclaim.py::test_reclaim_success PASSED               [ 56%]
runtime/tests/test_reclaim.py::test_reclaim_skipped_alive PASSED         [ 57%]
runtime/tests/test_reclaim.py::test_reclaim_not_stale PASSED             [ 57%]
runtime/tests/test_repair_context.py::test_truncate_short PASSED         [ 57%]
runtime/tests/test_repair_context.py::test_truncate_exact PASSED         [ 57%]
runtime/tests/test_repair_context.py::test_truncate_long PASSED          [ 57%]
runtime/tests/test_repair_context.py::test_truncate_unicode PASSED       [ 57%]
runtime/tests/test_required_artifact_ids.py::test_validate_limit_ok PASSED [ 57%]
runtime/tests/test_required_artifact_ids.py::test_validate_limit_exceeded PASSED [ 58%]
runtime/tests/test_required_artifact_ids.py::test_validate_invalid_type PASSED [ 58%]
runtime/tests/test_required_artifact_ids.py::test_validate_invalid_item_type PASSED [ 58%]
runtime/tests/test_routing.py::test_allowed_routes PASSED                [ 58%]
runtime/tests/test_routing.py::test_illegal_routes PASSED                [ 58%]
runtime/tests/test_run_controller.py::TestKillSwitch::test_kill_switch_not_present PASSED [ 58%]
runtime/tests/test_run_controller.py::TestKillSwitch::test_kill_switch_present PASSED [ 58%]
runtime/tests/test_run_controller.py::TestKillSwitch::test_mission_startup_halts_before_lock_when_kill_switch_present PASSED [ 58%]
runtime/tests/test_run_controller.py::TestKillSwitch::test_mission_startup_halts_after_lock_if_kill_switch_created_between_checks PASSED [ 59%]
runtime/tests/test_run_controller.py::TestRunLock::test_acquire_lock_success PASSED [ 59%]
runtime/tests/test_run_controller.py::TestRunLock::test_acquire_lock_fails_when_held PASSED [ 59%]
runtime/tests/test_run_controller.py::TestRunLock::test_stale_lock_detection PASSED [ 59%]
runtime/tests/test_run_controller.py::TestRunLock::test_release_lock_success PASSED [ 59%]
runtime/tests/test_run_controller.py::TestRunLock::test_release_lock_fails_if_not_owner PASSED [ 59%]
runtime/tests/test_run_controller.py::TestRepoClean::test_repo_clean_passes_on_clean_repo PASSED [ 59%]
runtime/tests/test_run_controller.py::TestRepoClean::test_repo_dirty_raises_on_staged_changes PASSED [ 59%]
runtime/tests/test_run_controller.py::TestRepoClean::test_repo_dirty_raises_on_untracked_files PASSED [ 60%]
runtime/tests/test_run_controller.py::TestGitFailClosed::test_git_status_nonzero_returncode_raises_halt PASSED [ 60%]
runtime/tests/test_run_controller.py::TestGitFailClosed::test_git_not_found_raises_halt PASSED [ 60%]
runtime/tests/test_run_controller.py::TestGitFailClosed::test_git_rev_parse_failure_raises_halt PASSED [ 60%]
runtime/tests/test_safety_halt_procedure.py::TestSafetyHaltProcedure::test_find_last_good_snapshot PASSED [ 60%]
runtime/tests/test_safety_halt_procedure.py::TestSafetyHaltProcedure::test_find_no_snapshot PASSED [ 60%]
runtime/tests/test_safety_halt_procedure.py::TestSafetyHaltProcedure::test_rollback_to_snapshot PASSED [ 60%]
runtime/tests/test_safety_health_checks.py::TestSafetyHealthChecks::test_amu0_chain_integrity_ok PASSED [ 60%]
runtime/tests/test_safety_health_checks.py::TestSafetyHealthChecks::test_amu0_readability_missing PASSED [ 61%]
runtime/tests/test_safety_health_checks.py::TestSafetyHealthChecks::test_amu0_readability_ok PASSED [ 61%]
runtime/tests/test_sandbox_remediation.py::test_unicode_safety_combining_marks PASSED [ 61%]
runtime/tests/test_sandbox_remediation.py::test_unicode_safety_normalization PASSED [ 61%]
runtime/tests/test_sandbox_remediation.py::test_resource_limit_file_size PASSED [ 61%]
runtime/tests/test_sandbox_remediation.py::test_hardlink_defense PASSED  [ 61%]
runtime/tests/test_sandbox_remediation.py::test_unicode_percent_rejection PASSED [ 61%]
runtime/tests/test_schema.py::test_json1_available PASSED                [ 61%]
runtime/tests/test_schema.py::test_tables_exist PASSED                   [ 62%]
runtime/tests/test_schema.py::test_columns_exist PASSED                  [ 62%]
runtime/tests/test_schema.py::test_indexes_exist PASSED                  [ 62%]
runtime/tests/test_self_mod_protection.py::TestProtectedPaths::test_governance_baseline_protected PASSED [ 62%]
runtime/tests/test_self_mod_protection.py::TestProtectedPaths::test_models_yaml_protected PASSED [ 62%]
runtime/tests/test_self_mod_protection.py::TestProtectedPaths::test_agent_roles_protected PASSED [ 62%]
runtime/tests/test_self_mod_protection.py::TestProtectedPaths::test_gate_policy_protected PASSED [ 62%]
runtime/tests/test_self_mod_protection.py::TestProtectedPaths::test_self_mod_protection_protected PASSED [ 62%]
runtime/tests/test_self_mod_protection.py::TestProtectedPaths::test_architecture_docs_protected PASSED [ 63%]
runtime/tests/test_self_mod_protection.py::TestProtectedPaths::test_constitutions_protected PASSED [ 63%]
runtime/tests/test_self_mod_protection.py::TestProtectedPaths::test_transforms_protected PASSED [ 63%]
runtime/tests/test_self_mod_protection.py::TestProtectedPaths::test_regular_file_not_protected PASSED [ 63%]
runtime/tests/test_self_mod_protection.py::TestProtectedPaths::test_path_normalization PASSED [ 63%]
runtime/tests/test_self_mod_protection.py::TestCheckSelfModification::test_protected_path_rejected PASSED [ 63%]
runtime/tests/test_self_mod_protection.py::TestCheckSelfModification::test_non_protected_path_allowed PASSED [ 63%]
runtime/tests/test_self_mod_protection.py::TestCheckSelfModification::test_evidence_includes_matching_patterns PASSED [ 63%]
runtime/tests/test_self_mod_protection.py::TestSelfModProtector::test_validate_protected_path PASSED [ 64%]
runtime/tests/test_self_mod_protection.py::TestSelfModProtector::test_validate_relative_path PASSED [ 64%]
runtime/tests/test_self_mod_protection.py::TestSelfModProtector::test_validate_absolute_path PASSED [ 64%]
runtime/tests/test_self_mod_protection.py::TestSelfModProtector::test_path_outside_repo_allowed PASSED [ 64%]
runtime/tests/test_self_mod_protection.py::TestGetProtectedPaths::test_returns_list PASSED [ 64%]
runtime/tests/test_self_mod_protection.py::TestGetProtectedPaths::test_includes_expected_paths PASSED [ 64%]
runtime/tests/test_snapshot.py::test_snapshot_basic PASSED               [ 64%]
runtime/tests/test_snapshot.py::test_snapshot_versioning PASSED          [ 65%]
runtime/tests/test_snapshot.py::test_snapshot_tombstone PASSED           [ 65%]
runtime/tests/test_snapshot.py::test_snapshot_required_artifact_override PASSED [ 65%]
runtime/tests/test_snapshot.py::test_snapshot_ordering PASSED            [ 65%]
runtime/tests/test_state_store.py::test_state_round_trip PASSED          [ 65%]
runtime/tests/test_state_store.py::test_snapshot_determinism PASSED      [ 65%]
runtime/tests/test_tier2_builder.py::test_build_workflow_daily_loop_produces_valid_workflow PASSED [ 65%]
runtime/tests/test_tier2_builder.py::test_build_workflow_run_tests_produces_valid_workflow PASSED [ 65%]
runtime/tests/test_tier2_builder.py::test_build_workflow_unknown_type_raises_error PASSED [ 66%]
runtime/tests/test_tier2_builder.py::test_build_workflow_respects_max_steps_limit PASSED [ 66%]
runtime/tests/test_tier2_builder.py::test_build_workflow_respects_max_human_steps_limit PASSED [ 66%]
runtime/tests/test_tier2_builder.py::test_build_workflow_excessive_steps_raises_or_truncates PASSED [ 66%]
runtime/tests/test_tier2_builder.py::test_build_workflow_excessive_human_steps_raises_or_truncates PASSED [ 66%]
runtime/tests/test_tier2_builder.py::test_build_workflow_is_deterministic PASSED [ 66%]
runtime/tests/test_tier2_builder.py::test_build_workflow_deterministic_across_runs PASSED [ 66%]
runtime/tests/test_tier2_builder.py::test_build_workflow_integrates_with_orchestrator PASSED [ 66%]
runtime/tests/test_tier2_builder.py::test_build_workflow_orchestrator_deterministic PASSED [ 67%]
runtime/tests/test_tier2_builder.py::test_build_workflow_does_not_cause_envelope_violation PASSED [ 67%]
runtime/tests/test_tier2_builder.py::test_build_workflow_empty_params_works PASSED [ 67%]
runtime/tests/test_tier2_builder.py::test_build_workflow_preserves_params_in_metadata PASSED [ 67%]
runtime/tests/test_tier2_config_adapter.py::test_parse_suite_success PASSED [ 67%]
runtime/tests/test_tier2_config_adapter.py::test_parse_suite_missing_fields PASSED [ 67%]
runtime/tests/test_tier2_config_adapter.py::test_parse_suite_invalid_types PASSED [ 67%]
runtime/tests/test_tier2_config_adapter.py::test_parse_expectations_success PASSED [ 67%]
runtime/tests/test_tier2_config_adapter.py::test_parse_expectations_invalid_op PASSED [ 68%]
runtime/tests/test_tier2_config_adapter.py::test_parse_expectations_missing_fields PASSED [ 68%]
runtime/tests/test_tier2_config_adapter.py::test_determinism_and_immutability PASSED [ 68%]
runtime/tests/test_tier2_config_adapter.py::test_ignore_extra_fields PASSED [ 68%]
runtime/tests/test_tier2_config_test_run.py::test_happy_path PASSED      [ 68%]
runtime/tests/test_tier2_config_test_run.py::test_failing_expectations PASSED [ 68%]
runtime/tests/test_tier2_config_test_run.py::test_determinism_and_immutability PASSED [ 68%]
runtime/tests/test_tier2_config_test_run.py::test_config_errors PASSED   [ 68%]
runtime/tests/test_tier2_contracts.py::test_run_workflow_contract_basic_shape PASSED [ 69%]
runtime/tests/test_tier2_contracts.py::test_run_workflow_does_not_mutate_input_workflow PASSED [ 69%]
runtime/tests/test_tier2_contracts.py::test_run_workflow_does_not_mutate_input_context_state PASSED [ 69%]
runtime/tests/test_tier2_contracts.py::test_run_workflow_records_human_steps_in_receipt PASSED [ 69%]
runtime/tests/test_tier2_contracts.py::test_orchestration_result_serialises_cleanly PASSED [ 69%]
runtime/tests/test_tier2_daily_loop.py::test_daily_loop_basic_contract PASSED [ 69%]
runtime/tests/test_tier2_daily_loop.py::test_daily_loop_returns_orchestration_result PASSED [ 69%]
runtime/tests/test_tier2_daily_loop.py::test_daily_loop_with_empty_params PASSED [ 69%]
runtime/tests/test_tier2_daily_loop.py::test_daily_loop_is_deterministic PASSED [ 70%]
runtime/tests/test_tier2_daily_loop.py::test_daily_loop_deterministic_across_multiple_runs PASSED [ 70%]
runtime/tests/test_tier2_daily_loop.py::test_daily_loop_respects_anti_failure_limits PASSED [ 70%]
runtime/tests/test_tier2_daily_loop.py::test_daily_loop_uses_only_allowed_step_kinds PASSED [ 70%]
runtime/tests/test_tier2_daily_loop.py::test_daily_loop_receipt_mentions_human_steps_if_present PASSED [ 70%]
runtime/tests/test_tier2_daily_loop.py::test_daily_loop_lineage_is_populated PASSED [ 70%]
runtime/tests/test_tier2_daily_loop.py::test_daily_loop_receipt_contains_all_executed_steps PASSED [ 70%]
runtime/tests/test_tier2_daily_loop.py::test_daily_loop_does_not_mutate_input_context PASSED [ 70%]
runtime/tests/test_tier2_daily_loop.py::test_daily_loop_does_not_mutate_params PASSED [ 71%]
runtime/tests/test_tier2_daily_loop.py::test_daily_loop_final_state_is_independent_of_input PASSED [ 71%]
runtime/tests/test_tier2_daily_loop.py::test_daily_loop_success_for_valid_workflow PASSED [ 71%]
runtime/tests/test_tier2_expectations.py::test_basic_success PASSED      [ 71%]
runtime/tests/test_tier2_expectations.py::test_duplicate_expectation_ids_raise_error PASSED [ 71%]
runtime/tests/test_tier2_expectations.py::test_expectations_collection_is_immutable PASSED [ 71%]
runtime/tests/test_tier2_expectations.py::test_failure_case PASSED       [ 71%]
runtime/tests/test_tier2_expectations.py::test_path_resolution PASSED    [ 72%]
runtime/tests/test_tier2_expectations.py::test_operator_behavior PASSED  [ 72%]
runtime/tests/test_tier2_expectations.py::test_determinism_and_metadata PASSED [ 72%]
runtime/tests/test_tier2_harness.py::test_single_mission_scenario PASSED [ 72%]
runtime/tests/test_tier2_harness.py::test_multi_mission_scenario PASSED  [ 72%]
runtime/tests/test_tier2_harness.py::test_empty_missions_scenario PASSED [ 72%]
runtime/tests/test_tier2_harness.py::test_scenario_determinism_for_same_inputs PASSED [ 72%]
runtime/tests/test_tier2_harness.py::test_scenario_determinism_across_multiple_runs PASSED [ 72%]
runtime/tests/test_tier2_harness.py::test_scenario_does_not_mutate_initial_state PASSED [ 73%]
runtime/tests/test_tier2_harness.py::test_scenario_does_not_mutate_mission_params PASSED [ 73%]
runtime/tests/test_tier2_harness.py::test_scenario_result_metadata_is_json_serialisable PASSED [ 73%]
runtime/tests/test_tier2_harness.py::test_scenario_result_metadata_contains_scenario_name PASSED [ 73%]
runtime/tests/test_tier2_harness.py::test_scenario_result_metadata_contains_stable_hash PASSED [ 73%]
runtime/tests/test_tier2_harness.py::test_scenario_hash_is_stable_across_runs PASSED [ 73%]
runtime/tests/test_tier2_harness.py::test_unknown_mission_propagates_error PASSED [ 73%]
runtime/tests/test_tier2_harness.py::test_error_after_successful_missions PASSED [ 73%]
runtime/tests/test_tier2_harness.py::test_scenario_result_is_fully_serialisable PASSED [ 74%]
runtime/tests/test_tier2_orchestrator.py::test_orchestrator_runs_steps_in_order PASSED [ 74%]
runtime/tests/test_tier2_orchestrator.py::test_orchestrator_respects_anti_failure_limits_max_steps PASSED [ 74%]
runtime/tests/test_tier2_orchestrator.py::test_orchestrator_respects_anti_failure_limits_max_human_steps PASSED [ 74%]
runtime/tests/test_tier2_orchestrator.py::test_orchestrator_is_deterministic_for_same_workflow_and_state PASSED [ 74%]
runtime/tests/test_tier2_orchestrator.py::test_orchestrator_records_lineage_and_receipt_deterministically PASSED [ 74%]
runtime/tests/test_tier2_orchestrator.py::test_orchestrator_halts_on_step_failure_with_deterministic_state PASSED [ 74%]
runtime/tests/test_tier2_orchestrator.py::test_orchestrator_enforces_execution_envelope PASSED [ 74%]
runtime/tests/test_tier2_orchestrator.py::test_executed_steps_are_snapshotted PASSED [ 75%]
runtime/tests/test_tier2_registry.py::test_registry_contains_core_missions PASSED [ 75%]
runtime/tests/test_tier2_registry.py::test_run_mission_dispatches_via_registry PASSED [ 75%]
runtime/tests/test_tier2_registry.py::test_unknown_mission_raises_unknownmissionerror PASSED [ 75%]
runtime/tests/test_tier2_registry.py::test_workflow_definition_enforces_id_name_consistency PASSED [ 75%]
runtime/tests/test_tier2_registry.py::test_run_mission_is_deterministic_for_same_inputs PASSED [ 75%]
runtime/tests/test_tier2_registry.py::test_run_mission_does_not_mutate_initial_state PASSED [ 75%]
runtime/tests/test_tier2_registry.py::test_integration_daily_loop_yields_serialisable_result PASSED [ 75%]
runtime/tests/test_tier2_registry.py::test_integration_echo_mission_executes_successfully PASSED [ 76%]
runtime/tests/test_tier2_suite.py::test_suite_runs_single_scenario PASSED [ 76%]
runtime/tests/test_tier2_suite.py::test_suite_runs_multiple_scenarios PASSED [ 76%]
runtime/tests/test_tier2_suite.py::test_suite_runs_empty_scenarios PASSED [ 76%]
runtime/tests/test_tier2_suite.py::test_suite_handles_duplicate_scenario_names PASSED [ 76%]
runtime/tests/test_tier2_suite.py::test_suite_is_deterministic_for_same_definition PASSED [ 76%]
runtime/tests/test_tier2_suite.py::test_suite_determinism_across_multiple_runs PASSED [ 76%]
runtime/tests/test_tier2_suite.py::test_suite_does_not_mutate_scenarios_or_initial_state PASSED [ 76%]
runtime/tests/test_tier2_suite.py::test_suite_metadata_is_json_serialisable PASSED [ 77%]
runtime/tests/test_tier2_suite.py::test_suite_metadata_contains_suite_name PASSED [ 77%]
runtime/tests/test_tier2_suite.py::test_suite_metadata_contains_stable_hash PASSED [ 77%]
runtime/tests/test_tier2_suite.py::test_suite_hash_is_stable_across_runs PASSED [ 77%]
runtime/tests/test_tier2_suite.py::test_unknown_mission_in_scenario_propagates_error PASSED [ 77%]
runtime/tests/test_tier2_suite.py::test_error_in_later_scenario_propagates PASSED [ 77%]
runtime/tests/test_tier2_suite.py::test_suite_result_is_fully_serialisable PASSED [ 77%]
runtime/tests/test_tier2_test_run.py::test_basic_integration_success PASSED [ 77%]
runtime/tests/test_tier2_test_run.py::test_failure_propagation PASSED    [ 78%]
runtime/tests/test_tier2_test_run.py::test_determinism PASSED            [ 78%]
runtime/tests/test_tier2_test_run.py::test_metadata_structure PASSED     [ 78%]
runtime/tests/test_tier2_test_run.py::test_metadata_hash_stability PASSED [ 78%]
runtime/tests/test_timeline_determinism.py::test_timeline_event_id_determinism PASSED [ 78%]
runtime/tests/test_timeline_determinism.py::test_timeline_event_id_uniqueness_sequential PASSED [ 78%]
runtime/tests/test_tokenizer_replay.py::test_context_determinism PASSED  [ 78%]
runtime/tests/test_tokenizer_replay.py::test_context_budget_truncation PASSED [ 79%]
runtime/tests/test_tokenizer_replay.py::test_tokenizer_persistence_and_replay PASSED [ 79%]
runtime/tests/test_validator_fake_agent_tasks.py::TestValidatorFakeAgentTasks::test_detect_human_review_in_agent PASSED [ 79%]
runtime/tests/test_validator_fake_agent_tasks.py::TestValidatorFakeAgentTasks::test_detect_requires_user_in_agent PASSED [ 79%]
runtime/tests/test_validator_smuggled_human_steps.py::TestValidatorSmuggledHumanSteps::test_clean_agent_step_no_warnings PASSED [ 79%]
runtime/tests/test_validator_smuggled_human_steps.py::TestValidatorSmuggledHumanSteps::test_detect_manual_in_agent_step PASSED [ 79%]
runtime/tests/test_validator_smuggled_human_steps.py::TestValidatorSmuggledHumanSteps::test_detect_user_must_in_agent PASSED [ 79%]
runtime/tests/test_validator_workflow_chaining_limit.py::TestValidatorWorkflowChainingLimit::test_chained_human_steps_exceed PASSED [ 79%]
runtime/tests/test_validator_workflow_chaining_limit.py::TestValidatorWorkflowChainingLimit::test_chained_workflows_exceed_steps PASSED [ 80%]
runtime/tests/test_validator_workflow_chaining_limit.py::TestValidatorWorkflowChainingLimit::test_single_workflow_within_limits PASSED [ 80%]
runtime/tests/test_workflow_validator.py::TestWorkflowValidator::test_create_agent_step PASSED [ 80%]
runtime/tests/test_workflow_validator.py::TestWorkflowValidator::test_create_human_step PASSED [ 80%]
runtime/tests/test_workflow_validator.py::TestWorkflowValidator::test_create_system_step PASSED [ 80%]
runtime/tests/test_workflow_validator.py::TestWorkflowValidator::test_custom_max_human_steps PASSED [ 80%]
runtime/tests/test_workflow_validator.py::TestWorkflowValidator::test_custom_max_steps PASSED [ 80%]
runtime/tests/test_workflow_validator.py::TestWorkflowValidator::test_invalid_routine_human_operations PASSED [ 80%]
runtime/tests/test_workflow_validator.py::TestWorkflowValidator::test_invalid_too_many_human_steps PASSED [ 81%]
runtime/tests/test_workflow_validator.py::TestWorkflowValidator::test_invalid_too_many_steps PASSED [ 81%]
runtime/tests/test_workflow_validator.py::TestWorkflowValidator::test_routine_allowed_when_configured PASSED [ 81%]
runtime/tests/test_workflow_validator.py::TestWorkflowValidator::test_suggestions_for_routine_automation PASSED [ 81%]
runtime/tests/test_workflow_validator.py::TestWorkflowValidator::test_suggestions_for_too_many_steps PASSED [ 81%]
runtime/tests/test_workflow_validator.py::TestWorkflowValidator::test_valid_empty_workflow PASSED [ 81%]
runtime/tests/test_workflow_validator.py::TestWorkflowValidator::test_valid_workflow_2_human_steps PASSED [ 81%]
runtime/tests/test_workflow_validator.py::TestWorkflowValidator::test_valid_workflow_5_agent_steps PASSED [ 81%]
runtime/tests/test_workflow_validator.py::TestWorkflowValidator::test_validate_mission PASSED [ 82%]
runtime/tests/test_workflow_validator.py::TestWorkflowValidator::test_validate_or_raise_passes PASSED [ 82%]
runtime/tests/test_workflow_validator.py::TestWorkflowValidator::test_validate_or_raise_raises PASSED [ 82%]
tests_doc/test_dap_compliance.py::test_dap_compliance PASSED             [ 82%]
tests_doc/test_index_consistency.py::test_index_consistency SKIPPED      [ 82%]
tests_doc/test_links.py::test_link_integrity FAILED                      [ 82%]
tests_doc/test_tdd_compliance.py::test_core_tdd_compliance PASSED        [ 82%]
tests_doc/test_tdd_compliance.py::test_violations_detected_selftest[import time\ntime.time()-Call 'time.time' forbidden] PASSED [ 82%]
tests_doc/test_tdd_compliance.py::test_violations_detected_selftest[import datetime\ndatetime.datetime.now()-Call 'datetime.datetime.now' forbidden] PASSED [ 83%]
tests_doc/test_tdd_compliance.py::test_violations_detected_selftest[import requests-Import 'requests' forbidden] PASSED [ 83%]
tests_doc/test_tdd_compliance.py::test_violations_detected_selftest[import urllib.request-Import 'urllib.request' forbidden] PASSED [ 83%]
tests_doc/test_tdd_compliance.py::test_violations_detected_selftest[import uuid\nx = uuid.uuid4()-Call 'uuid.uuid4' forbidden] PASSED [ 83%]
tests_doc/test_tdd_compliance.py::test_violations_detected_selftest[import secrets-Import 'secrets' forbidden] PASSED [ 83%]
tests_doc/test_tdd_compliance.py::test_violations_detected_selftest[import time\ntime.monotonic()-Call 'time.monotonic' forbidden] PASSED [ 83%]
tests_doc/test_tdd_compliance.py::test_violations_detected_selftest[eval('os.system("rm -rf")')-Call 'eval' forbidden] PASSED [ 83%]
tests_doc/test_tdd_compliance.py::test_violations_detected_selftest[exec('import os')-Call 'exec' forbidden] PASSED [ 83%]
tests_doc/test_tdd_compliance.py::test_violations_detected_selftest[__import__('os')-Call '__import__' forbidden] PASSED [ 84%]
tests_doc/test_tdd_compliance.py::test_violations_detected_selftest[import importlib\nimportlib.import_module('os')-Import 'importlib' forbidden] PASSED [ 84%]
tests_recursive/test_autogate_rules.py::test_autogate_low_risk PASSED    [ 84%]
tests_recursive/test_autogate_rules.py::test_autogate_high_risk_path PASSED [ 84%]
tests_recursive/test_autogate_rules.py::test_autogate_diff_limit PASSED  [ 84%]
tests_recursive/test_opencode_gate_policy.py::TestNormalizePath::test_backslash_conversion PASSED [ 84%]
tests_recursive/test_opencode_gate_policy.py::TestNormalizePath::test_strip_leading_dot_slash PASSED [ 84%]
tests_recursive/test_opencode_gate_policy.py::TestNormalizePath::test_collapse_repeated_slashes PASSED [ 84%]
tests_recursive/test_opencode_gate_policy.py::TestNormalizePath::test_lowercase PASSED [ 85%]
tests_recursive/test_opencode_gate_policy.py::TestNormalizePath::test_gemini_case PASSED [ 85%]
tests_recursive/test_opencode_gate_policy.py::TestNormalizePath::test_mixed_normalization PASSED [ 85%]
tests_recursive/test_opencode_gate_policy.py::TestPathSecurity::test_traversal_blocked PASSED [ 85%]
tests_recursive/test_opencode_gate_policy.py::TestPathSecurity::test_absolute_unix_blocked PASSED [ 85%]
tests_recursive/test_opencode_gate_policy.py::TestPathSecurity::test_absolute_windows_blocked PASSED [ 85%]
tests_recursive/test_opencode_gate_policy.py::TestPathSecurity::test_normal_path_allowed PASSED [ 85%]
tests_recursive/test_opencode_gate_policy.py::TestDenylistMatching::test_denylist_root_config PASSED [ 86%]
tests_recursive/test_opencode_gate_policy.py::TestDenylistMatching::test_denylist_root_foundations PASSED [ 86%]
tests_recursive/test_opencode_gate_policy.py::TestDenylistMatching::test_denylist_root_governance PASSED [ 86%]
tests_recursive/test_opencode_gate_policy.py::TestDenylistMatching::test_denylist_exact_gemini PASSED [ 86%]
tests_recursive/test_opencode_gate_policy.py::TestDenylistMatching::test_denylist_extension_py PASSED [ 86%]
tests_recursive/test_opencode_gate_policy.py::TestDenylistMatching::test_allowed_path_not_denied PASSED [ 86%]
tests_recursive/test_opencode_gate_policy.py::TestDenylistMatching::test_case_bypass_gemini PASSED [ 86%]
tests_recursive/test_opencode_gate_policy.py::TestDenylistMatching::test_case_bypass_foundations PASSED [ 86%]
tests_recursive/test_opencode_gate_policy.py::TestExtensionRestriction::test_md_allowed PASSED [ 87%]
tests_recursive/test_opencode_gate_policy.py::TestExtensionRestriction::test_json_blocked PASSED [ 87%]
tests_recursive/test_opencode_gate_policy.py::TestExtensionRestriction::test_txt_blocked PASSED [ 87%]
tests_recursive/test_opencode_gate_policy.py::TestExtensionRestriction::test_double_extension_blocked PASSED [ 87%]
tests_recursive/test_opencode_gate_policy.py::TestReviewPacketsAddOnly::test_add_md_allowed PASSED [ 87%]
tests_recursive/test_opencode_gate_policy.py::TestReviewPacketsAddOnly::test_modify_blocked PASSED [ 87%]
tests_recursive/test_opencode_gate_policy.py::TestReviewPacketsAddOnly::test_delete_blocked PASSED [ 87%]
tests_recursive/test_opencode_gate_policy.py::TestReviewPacketsAddOnly::test_non_md_blocked PASSED [ 87%]
tests_recursive/test_opencode_gate_policy.py::TestGitStatusParsing::test_parse_add PASSED [ 88%]
tests_recursive/test_opencode_gate_policy.py::TestGitStatusParsing::test_parse_modify PASSED [ 88%]
tests_recursive/test_opencode_gate_policy.py::TestGitStatusParsing::test_parse_delete PASSED [ 88%]
tests_recursive/test_opencode_gate_policy.py::TestGitStatusParsing::test_parse_rename PASSED [ 88%]
tests_recursive/test_opencode_gate_policy.py::TestGitStatusParsing::test_parse_empty PASSED [ 88%]
tests_recursive/test_opencode_gate_policy.py::TestBlockedOpsDetection::test_delete_blocked PASSED [ 88%]
tests_recursive/test_opencode_gate_policy.py::TestBlockedOpsDetection::test_rename_blocked PASSED [ 88%]
tests_recursive/test_opencode_gate_policy.py::TestBlockedOpsDetection::test_copy_blocked PASSED [ 88%]
tests_recursive/test_opencode_gate_policy.py::TestBlockedOpsDetection::test_add_modify_not_blocked PASSED [ 89%]
tests_recursive/test_opencode_gate_policy.py::TestIndexDiscovery::test_governance_index_excluded PASSED [ 89%]
tests_recursive/test_opencode_gate_policy.py::TestIndexDiscovery::test_docs_root_index_included PASSED [ 89%]
tests_recursive/test_opencode_gate_policy.py::TestIndexDiscovery::test_review_packets_not_in_index PASSED [ 89%]
tests_recursive/test_opencode_gate_policy.py::TestHashing::test_hash_format PASSED [ 89%]
tests_recursive/test_opencode_gate_policy.py::TestTruncation::test_no_truncation_small PASSED [ 89%]
tests_recursive/test_opencode_gate_policy.py::TestTruncation::test_truncation_footer_format PASSED [ 89%]
tests_recursive/test_opencode_gate_policy.py::TestRunnerLogHygiene::test_runner_source_no_ellipses_in_logs PASSED [ 89%]
tests_recursive/test_opencode_gate_policy.py::TestSymlinkDefense::test_symlink_reason_code_exists PASSED [ 90%]
tests_recursive/test_opencode_gate_policy.py::TestSymlinkDefense::test_symlink_filesystem_regular_file PASSED [ 90%]
tests_recursive/test_opencode_gate_policy.py::TestSymlinkDefense::test_symlink_filesystem_detects_symlink SKIPPED [ 90%]
tests_recursive/test_opencode_gate_policy.py::TestSymlinkDefense::test_symlink_in_parent_path SKIPPED [ 90%]
tests_recursive/test_opencode_gate_policy.py::TestGoldenFixturesRenameCopy::test_golden_rename_r100 PASSED [ 90%]
tests_recursive/test_opencode_gate_policy.py::TestGoldenFixturesRenameCopy::test_golden_copy_c100 PASSED [ 90%]
tests_recursive/test_opencode_gate_policy.py::TestGoldenFixturesRenameCopy::test_golden_mixed_operations PASSED [ 90%]
tests_recursive/test_opencode_gate_policy.py::TestBoundarySafeMatching::test_docsx_does_not_match_docs PASSED [ 90%]
tests_recursive/test_opencode_gate_policy.py::TestBoundarySafeMatching::test_docs_matches_docs PASSED [ 91%]
tests_recursive/test_opencode_gate_policy.py::TestBoundarySafeMatching::test_docs_with_trailing_slashes PASSED [ 91%]
tests_recursive/test_opencode_gate_policy.py::TestBoundarySafeMatching::test_artifacts_review_packets_prefix PASSED [ 91%]
tests_recursive/test_opencode_gate_policy.py::TestBoundarySafeMatching::test_config_denylist_prefix PASSED [ 91%]
tests_recursive/test_opencode_gate_policy.py::TestCIDiffFailClosed::test_diff_exec_failed_reason_code_exists PASSED [ 91%]
tests_recursive/test_opencode_gate_policy.py::TestCIDiffFailClosed::test_refs_unavailable_reason_code_exists PASSED [ 91%]
tests_recursive/test_opencode_gate_policy.py::TestCIDiffFailClosed::test_merge_base_failed_reason_code_exists PASSED [ 91%]
tests_recursive/test_opencode_gate_policy.py::TestCIDiffFailClosedMocked::test_refs_unavailable_when_github_base_ref_missing PASSED [ 91%]
tests_recursive/test_opencode_gate_policy.py::TestCIDiffFailClosedMocked::test_refs_unavailable_when_github_sha_missing PASSED [ 92%]
tests_recursive/test_opencode_gate_policy.py::TestCIDiffFailClosedMocked::test_merge_base_failed_on_subprocess_error PASSED [ 92%]
tests_recursive/test_opencode_gate_policy.py::TestCIDiffFailClosedMocked::test_diff_exec_failed_on_exception PASSED [ 92%]
tests_recursive/test_opencode_gate_policy.py::TestCIDiffFailClosedMocked::test_successful_diff_returns_parsed_list PASSED [ 92%]
tests_recursive/test_opencode_gate_policy.py::TestSymlinkGitIndexMocked::test_git_index_symlink_mode_120000_detected PASSED [ 92%]
tests_recursive/test_opencode_gate_policy.py::TestSymlinkGitIndexMocked::test_git_index_regular_file_mode_100644_not_flagged PASSED [ 92%]
tests_recursive/test_opencode_gate_policy.py::TestSymlinkGitIndexMocked::test_git_index_executable_mode_100755_not_flagged PASSED [ 92%]
tests_recursive/test_opencode_gate_policy.py::TestSymlinkGitIndexMocked::test_git_index_empty_response_not_flagged PASSED [ 93%]
tests_recursive/test_opencode_gate_policy.py::TestSymlinkGitIndexMocked::test_git_index_exception_blocks_fail_closed PASSED [ 93%]
tests_recursive/test_opencode_gate_policy.py::TestSymlinkGitIndexMocked::test_git_index_nonzero_return_blocks_fail_closed PASSED [ 93%]
tests_recursive/test_opencode_gate_policy.py::TestBoundaryMatchingStrict::test_docsx_strictly_not_allowed PASSED [ 93%]
tests_recursive/test_opencode_gate_policy.py::TestBoundaryMatchingStrict::test_artifacts_review_packets_underscore_strictly_blocked PASSED [ 93%]
tests_recursive/test_opencode_gate_policy.py::TestBoundaryMatchingStrict::test_docs_strictly_allowed PASSED [ 93%]
tests_recursive/test_opencode_gate_policy.py::TestBoundaryMatchingStrict::test_artifacts_review_packets_strictly_allowed PASSED [ 93%]
tests_recursive/test_opencode_gate_policy.py::TestBoundaryMatchingStrict::test_root_file_strictly_blocked PASSED [ 93%]
tests_recursive/test_opencode_gate_policy.py::TestRunnerEnvelopeEnforcement::test_denylisted_path_blocked PASSED [ 94%]
tests_recursive/test_opencode_gate_policy.py::TestRunnerEnvelopeEnforcement::test_denylisted_governance_blocked PASSED [ 94%]
tests_recursive/test_opencode_gate_policy.py::TestRunnerEnvelopeEnforcement::test_denylisted_scripts_blocked PASSED [ 94%]
tests_recursive/test_opencode_gate_policy.py::TestRunnerEnvelopeEnforcement::test_outside_allowlist_blocked PASSED [ 94%]
tests_recursive/test_opencode_gate_policy.py::TestRunnerEnvelopeEnforcement::test_non_md_under_docs_blocked PASSED [ 94%]
tests_recursive/test_opencode_gate_policy.py::TestRunnerEnvelopeEnforcement::test_yaml_under_docs_blocked PASSED [ 94%]
tests_recursive/test_opencode_gate_policy.py::TestRunnerEnvelopeEnforcement::test_review_packets_modify_blocked PASSED [ 94%]
tests_recursive/test_opencode_gate_policy.py::TestRunnerEnvelopeEnforcement::test_review_packets_delete_blocked PASSED [ 94%]
tests_recursive/test_opencode_gate_policy.py::TestRunnerEnvelopeEnforcement::test_review_packets_rename_blocked PASSED [ 95%]
tests_recursive/test_opencode_gate_policy.py::TestRunnerEnvelopeEnforcement::test_review_packets_add_non_md_blocked PASSED [ 95%]
tests_recursive/test_opencode_gate_policy.py::TestRunnerEnvelopeEnforcement::test_review_packets_add_md_allowed PASSED [ 95%]
tests_recursive/test_opencode_gate_policy.py::TestRunnerEnvelopeEnforcement::test_docs_add_md_allowed PASSED [ 95%]
tests_recursive/test_opencode_gate_policy.py::TestRunnerEnvelopeEnforcement::test_docs_modify_md_allowed PASSED [ 95%]
tests_recursive/test_opencode_gate_policy.py::TestRunnerEnvelopeEnforcement::test_any_delete_blocked PASSED [ 95%]
tests_recursive/test_opencode_gate_policy.py::TestRunnerEnvelopeEnforcement::test_any_copy_blocked PASSED [ 95%]
tests_recursive/test_planner_basic.py::test_planner_basic PASSED         [ 95%]
tests_recursive/test_planner_basic.py::test_planner_real_config PASSED   [ 96%]
tests_recursive/test_steward_runner.py::TestAT01MissingRunId::test_missing_run_id_fails FAILED [ 96%]
tests_recursive/test_steward_runner.py::TestAT02DirtyRepoStart::test_dirty_repo_fails_with_require_clean PASSED [ 96%]
tests_recursive/test_steward_runner.py::TestAT03TestsFailureBlocksDownstream::test_tests_failure_blocks_validators PASSED [ 96%]
tests_recursive/test_steward_runner.py::TestAT04ValidatorFailureBlocksCorpus::test_validator_failure_blocks_corpus PASSED [ 96%]
tests_recursive/test_steward_runner.py::TestAT05CorpusExpectedOutputsEnforced::test_missing_corpus_output_fails PASSED [ 96%]
tests_recursive/test_steward_runner.py::TestAT06NoChangeNoCommit::test_no_change_exits_success FAILED [ 96%]
tests_recursive/test_steward_runner.py::TestAT07ChangeWithinAllowedPathsCommits::test_allowed_change_commits FAILED [ 96%]
tests_recursive/test_steward_runner.py::TestAT08ChangeOutsideAllowedPathsFails::test_disallowed_change_fails PASSED [ 97%]
tests_recursive/test_steward_runner.py::TestAT09DryRunNeverCommits::test_dry_run_skips_commit FAILED [ 97%]
tests_recursive/test_steward_runner.py::TestAT10LogDeterminism::test_logs_are_deterministic FAILED [ 97%]
tests_recursive/test_steward_runner.py::TestAT11TestScopeEnforcement::test_tests_argv_includes_paths FAILED [ 97%]
tests_recursive/test_steward_runner.py::TestAT12AllowlistNormalization::test_bare_name_normalized_to_directory XFAIL [ 97%]
tests_recursive/test_steward_runner.py::TestAT13FailClosedUnsafePaths::test_unsafe_path_fails[../docs/-path_traversal] FAILED [ 97%]
tests_recursive/test_steward_runner.py::TestAT13FailClosedUnsafePaths::test_unsafe_path_fails[docs/../other/-path_traversal] FAILED [ 97%]
tests_recursive/test_steward_runner.py::TestAT13FailClosedUnsafePaths::test_unsafe_path_fails[docs/*.md-glob_pattern] FAILED [ 97%]
tests_recursive/test_steward_runner.py::TestAT13FailClosedUnsafePaths::test_unsafe_path_fails[docs/?.md-glob_pattern] FAILED [ 98%]
tests_recursive/test_steward_runner.py::TestAT13FailClosedUnsafePaths::test_unsafe_path_fails[C:/temp/-absolute_path_windows] FAILED [ 98%]
tests_recursive/test_steward_runner.py::TestAT13FailClosedUnsafePaths::test_unsafe_path_fails[C:\\temp\\-absolute_path_windows] FAILED [ 98%]
tests_recursive/test_steward_runner.py::TestAT13FailClosedUnsafePaths::test_unsafe_path_fails[/absolute/path/-absolute_path_unix0] FAILED [ 98%]
tests_recursive/test_steward_runner.py::TestAT13FailClosedUnsafePaths::test_unsafe_path_fails[/absolute/path/-absolute_path_unix1] FAILED [ 98%]
tests_recursive/test_steward_runner.py::TestAT13FailClosedUnsafePaths::test_unsafe_path_fails[//server/share/-absolute_path_unc] FAILED [ 98%]
tests_recursive/test_steward_runner.py::TestAT13FailClosedUnsafePaths::test_unsafe_path_fails[docs%2Ffolder-url_encoded_chars] FAILED [ 98%]
tests_recursive/test_steward_runner.py::TestAT14DirtyDuringRun::test_dirty_during_run_rejected FAILED [ 98%]
tests_recursive/test_steward_runner.py::TestAT15LogFieldSorting::test_log_lists_are_sorted FAILED [ 99%]
tests_recursive/test_steward_runner.py::TestAT16DefaultDryRun::test_no_flags_is_dry_run FAILED [ 99%]
tests_recursive/test_steward_runner.py::TestAT17CommitFlagEnables::test_commit_flag_enables FAILED [ 99%]
tests_recursive/test_steward_runner.py::TestAT18ExplicitDryRun::test_explicit_dry_run FAILED [ 99%]
tests_recursive/test_verifier_mock.py::test_verifier_success PASSED      [ 99%]
tests_recursive/test_verifier_mock.py::test_verifier_failure PASSED      [ 99%]
tests_recursive/test_verifier_mock.py::test_fp005_verifier_with_cwd PASSED [ 99%]
tests_recursive/test_verifier_mock.py::test_fp005_verifier_default_cwd PASSED [100%]

================================== FAILURES ===================================
___________________ TestLLMCall.test_llm_call_default_model ___________________

self = <runtime.tests.test_opencode_client.TestLLMCall object at 0x0000020586B65A30>

    def test_llm_call_default_model(self):
        """LLMCall should have sensible default model."""
        call = LLMCall(prompt="Hello")
        assert call.prompt == "Hello"
>       assert call.model == "openrouter/anthropic/claude-sonnet-4"
E       AssertionError: assert 'x-ai/grok-4.1-fast' == 'openrouter/a...aude-sonnet-4'
E         
E         - openrouter/anthropic/claude-sonnet-4
E         + x-ai/grok-4.1-fast

runtime\tests\test_opencode_client.py:37: AssertionError
_______________ TestServerState.test_call_without_server_raises _______________

self = <runtime.tests.test_opencode_client.TestServerState object at 0x0000020586B674A0>

    def test_call_without_server_raises(self):
        """Calling without server should raise error."""
        client = OpenCodeClient()
>       with pytest.raises(OpenCodeServerError, match="Server not running"):
E       Failed: DID NOT RAISE <class 'runtime.agents.opencode_client.OpenCodeServerError'>

runtime\tests\test_opencode_client.py:214: Failed
_________________ TestImports.test_import_from_agents_package _________________

self = <runtime.tests.test_opencode_client.TestImports object at 0x0000020586B67A40>

    def test_import_from_agents_package(self):
        """Should be able to import from runtime.agents."""
>       from runtime.agents import (
            OpenCodeClient,
            LLMCall,
            LLMResponse,
            OpenCodeError,
            OpenCodeServerError,
            OpenCodeTimeoutError,
        )
E       ImportError: cannot import name 'OpenCodeClient' from 'runtime.agents' (C:\Users\cabra\Projects\LifeOS\runtime\agents\__init__.py)

runtime\tests\test_opencode_client.py:258: ImportError
________________________ TestImports.test_all_exports _________________________

self = <runtime.tests.test_opencode_client.TestImports object at 0x0000020586B67BF0>

    def test_all_exports(self):
        """__all__ should export expected symbols."""
        from runtime import agents
        expected = [
            "OpenCodeClient",
            "LLMCall",
            "LLMResponse",
            "OpenCodeError",
            "OpenCodeServerError",
            "OpenCodeTimeoutError",
        ]
        for name in expected:
>           assert hasattr(agents, name), f"Missing export: {name}"
E           AssertionError: Missing export: OpenCodeClient
E           assert False
E            +  where False = hasattr(<module 'runtime.agents' from 'C:\\Users\\cabra\\Projects\\LifeOS\\runtime\\agents\\__init__.py'>, 'OpenCodeClient')

runtime\tests\test_opencode_client.py:282: AssertionError
_____________________ test_t5_canonical_evidence_capture ______________________

tmp_path = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_t5_canonical_evidence_cap0')

    def test_t5_canonical_evidence_capture(tmp_path):
        """T5: steward_runner captures multiline output without elision (Isolated)."""
    
        # 1. Setup Isolated Logging (P0-4)
        # Using tmp_path for isolation.
        # Absolute paths required for steward_runner config when running from REPO_ROOT.
        log_dir = tmp_path / "logs"
        streams_dir = log_dir / "streams"
    
        # Generate unique run ID for contamination proofing (P0-5)
        run_id = f"test_t5_{tmp_path.name}"
    
        log_dir_str = str(log_dir).replace(os.sep, '/')
        streams_dir_str = str(streams_dir).replace(os.sep, '/')
    
        config_content = f"""
    logging:
      log_dir: "{log_dir_str}"
      streams_dir: "{streams_dir_str}"
    determinism:
      timestamps: false
    """
        config_file = tmp_path / "t5_config.yaml"
        config_file.write_text(config_content, encoding="utf-8")
    
        # 2. Create a script that prints multiline output
        script_content = """
    for i in range(100):
        print(f"Line {i}: This is a test line for evidence capture verification.")
    """
        script_file = tmp_path / "print_huge.py"
        script_file.write_text(script_content, encoding="utf-8")
    
        # 3. Invoke steward_runner manually via subprocess
    
        full_config_content = f"""
    logging:
      log_dir: "{log_dir_str}"
      streams_dir: "{streams_dir_str}"
    validators:
      commands:
        - ["{sys.executable.replace(os.sep, '/')}", "{str(script_file).replace(os.sep, '/')}"]
    """
        config_file.write_text(full_config_content, encoding="utf-8")
    
        runner_path = REPO_ROOT / "scripts" / "steward_runner.py"
    
        cmd = [
            sys.executable, str(runner_path),
            "--config", str(config_file),
            "--run-id", run_id,
            "--step", "validators"
        ]
    
        # Run it
        res = subprocess.run(cmd, cwd=REPO_ROOT, capture_output=True, text=True)
        if res.returncode != 0:
            print(f"STDOUT: {res.stdout}")
            print(f"STDERR: {res.stderr}")
>       assert res.returncode == 0, f"Runner failed with code {res.returncode}"
E       AssertionError: Runner failed with code 2
E       assert 2 == 0
E        +  where 2 = CompletedProcess(args=['C:\\Python312\\python.exe', 'C:\\Users\\cabra\\Projects\\LifeOS\\scripts\\steward_runner.py', '--config', 'C:\\Users\\cabra\\AppData\\Local\\Temp\\pytest-of-cabra\\pytest-363\\test_t5_canonical_evidence_cap0\\t5_config.yaml', '--run-id', 'test_t5_test_t5_canonical_evidence_cap0', '--step', 'validators'], returncode=2, stdout='', stderr="C:\\Python312\\python.exe: can't open file 'C:\\\\Users\\\\cabra\\\\Projects\\\\LifeOS\\\\scripts\\\\steward_runner.py': [Errno 2] No such file or directory\n").returncode

runtime\tests\test_opencode_governance\test_phase1_contract.py:207: AssertionError
---------------------------- Captured stdout call -----------------------------
STDOUT: 
STDERR: C:\Python312\python.exe: can't open file 'C:\\Users\\cabra\\Projects\\LifeOS\\scripts\\steward_runner.py': [Errno 2] No such file or directory

_____________________________ test_link_integrity _____________________________

    def test_link_integrity():
        """
        Verify all internal links in canonical docs resolve to existing files.
    
        Scope:
        - docs/00_foundations/
        - docs/01_governance/
    
        Skips:
        - External links (http://, https://, mailto:)
        - Anchor-only links (#...)
        - Template tokens ({...})
        - Files outside canonical roots
        """
        repo_root = os.getcwd()
        docs_root = os.path.join(repo_root, "docs")
    
        # Uses CANONICAL_ROOTS by default (explicit allowlist)
        errors = check_links(docs_root)
    
>       assert not errors, f"Broken internal links found:\n" + "\n".join(errors)
E       AssertionError: Broken internal links found:
E         Broken link in 00_foundations\Tier_Definition_Spec_v1.1.md: ../02_protocols/F3_Tier2.5_Activation_Conditions_Checklist_v1.0.md
E         Broken link in 00_foundations\Tier_Definition_Spec_v1.1.md: ../02_protocols/F4_Tier2.5_Deactivation_Rollback_Conditions_v1.0.md
E         Broken link in 00_foundations\Tier_Definition_Spec_v1.1.md: ../02_protocols/F7_Runtime_Antigrav_Mission_Protocol_v1.0.md
E         Broken link in 01_governance\OpenCode_First_Stewardship_Policy_v1.0.md: scripts/opencode_ci_runner.py
E         Broken link in 01_governance\OpenCode_First_Stewardship_Policy_v1.0.md: scripts/opencode_gate_policy.py
E         Broken link in 01_governance\OpenCode_First_Stewardship_Policy_v1.0.md: docs/01_governance/Council_Ruling_OpenCode_DocSteward_CT2_Phase2_v1.1.md
E       assert not ['Broken link in 00_foundations\\Tier_Definition_Spec_v1.1.md: ../02_protocols/F3_Tier2.5_Activation_Conditions_Checklist_v1.0.md', 'Broken link in 00_foundations\\Tier_Definition_Spec_v1.1.md: ../02_protocols/F4_Tier2.5_Deactivation_Rollback_Conditions_v1.0.md', 'Broken link in 00_foundations\\Tier_Definition_Spec_v1.1.md: ../02_protocols/F7_Runtime_Antigrav_Mission_Protocol_v1.0.md', 'Broken link in 01_governance\\OpenCode_First_Stewardship_Policy_v1.0.md: scripts/opencode_ci_runner.py', 'Broken link in 01_governance\\OpenCode_First_Stewardship_Policy_v1.0.md: scripts/opencode_gate_policy.py', 'Broken link in 01_governance\\OpenCode_First_Stewardship_Policy_v1.0.md: docs/01_governance/Council_Ruling_OpenCode_DocSteward_CT2_Phase2_v1.1.md']

tests_doc\test_links.py:32: AssertionError
_______________ TestAT01MissingRunId.test_missing_run_id_fails ________________

self = <tests_recursive.test_steward_runner.TestAT01MissingRunId object at 0x0000020586DCEDE0>
worktree = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_missing_run_id_fails0/test_worktree')
test_config = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_missing_run_id_fails0/test_worktree/config/test_runner.yaml')

    def test_missing_run_id_fails(self, worktree: Path, test_config: Path):
        """Invoke without --run-id \u2192 exit != 0."""
        runner_path = worktree / "scripts" / "steward_runner.py"
    
        result = subprocess.run(
            ["python", str(runner_path), "--config", str(test_config.relative_to(worktree))],
            cwd=worktree,
            capture_output=True,
            text=True,
        )
    
        assert result.returncode != 0, "Should fail without --run-id"
>       assert "required" in result.stderr.lower() or "run-id" in result.stderr.lower()
E       assert ('required' in "python: can't open file 'c:\\\\users\\\\cabra\\\\appdata\\\\local\\\\temp\\\\pytest-of-cabra\\\\pytest-363\\\\test_missing_run_id_fails0\\\\test_worktree\\\\scripts\\\\steward_runner.py': [errno 2] no such file or directory\n" or 'run-id' in "python: can't open file 'c:\\\\users\\\\cabra\\\\appdata\\\\local\\\\temp\\\\pytest-of-cabra\\\\pytest-363\\\\test_missing_run_id_fails0\\\\test_worktree\\\\scripts\\\\steward_runner.py': [errno 2] no such file or directory\n")
E        +  where "python: can't open file 'c:\\\\users\\\\cabra\\\\appdata\\\\local\\\\temp\\\\pytest-of-cabra\\\\pytest-363\\\\test_missing_run_id_fails0\\\\test_worktree\\\\scripts\\\\steward_runner.py': [errno 2] no such file or directory\n" = <built-in method lower of str object at 0x000002058547E430>()
E        +    where <built-in method lower of str object at 0x000002058547E430> = "python: can't open file 'C:\\\\Users\\\\cabra\\\\AppData\\\\Local\\\\Temp\\\\pytest-of-cabra\\\\pytest-363\\\\test_missing_run_id_fails0\\\\test_worktree\\\\scripts\\\\steward_runner.py': [Errno 2] No such file or directory\n".lower
E        +      where "python: can't open file 'C:\\\\Users\\\\cabra\\\\AppData\\\\Local\\\\Temp\\\\pytest-of-cabra\\\\pytest-363\\\\test_missing_run_id_fails0\\\\test_worktree\\\\scripts\\\\steward_runner.py': [Errno 2] No such file or directory\n" = CompletedProcess(args=['python', 'C:\\Users\\cabra\\AppData\\Local\\Temp\\pytest-of-cabra\\pytest-363\\test_missing_run_id_fails0\\test_worktree\\scripts\\steward_runner.py', '--config', 'config\\test_runner.yaml'], returncode=2, stdout='', stderr="python: can't open file 'C:\\\\Users\\\\cabra\\\\AppData\\\\Local\\\\Temp\\\\pytest-of-cabra\\\\pytest-363\\\\test_missing_run_id_fails0\\\\test_worktree\\\\scripts\\\\steward_runner.py': [Errno 2] No such file or directory\n").stderr
E        +  and   "python: can't open file 'c:\\\\users\\\\cabra\\\\appdata\\\\local\\\\temp\\\\pytest-of-cabra\\\\pytest-363\\\\test_missing_run_id_fails0\\\\test_worktree\\\\scripts\\\\steward_runner.py': [errno 2] no such file or directory\n" = <built-in method lower of str object at 0x000002058547E430>()
E        +    where <built-in method lower of str object at 0x000002058547E430> = "python: can't open file 'C:\\\\Users\\\\cabra\\\\AppData\\\\Local\\\\Temp\\\\pytest-of-cabra\\\\pytest-363\\\\test_missing_run_id_fails0\\\\test_worktree\\\\scripts\\\\steward_runner.py': [Errno 2] No such file or directory\n".lower
E        +      where "python: can't open file 'C:\\\\Users\\\\cabra\\\\AppData\\\\Local\\\\Temp\\\\pytest-of-cabra\\\\pytest-363\\\\test_missing_run_id_fails0\\\\test_worktree\\\\scripts\\\\steward_runner.py': [Errno 2] No such file or directory\n" = CompletedProcess(args=['python', 'C:\\Users\\cabra\\AppData\\Local\\Temp\\pytest-of-cabra\\pytest-363\\test_missing_run_id_fails0\\test_worktree\\scripts\\steward_runner.py', '--config', 'config\\test_runner.yaml'], returncode=2, stdout='', stderr="python: can't open file 'C:\\\\Users\\\\cabra\\\\AppData\\\\Local\\\\Temp\\\\pytest-of-cabra\\\\pytest-363\\\\test_missing_run_id_fails0\\\\test_worktree\\\\scripts\\\\steward_runner.py': [Errno 2] No such file or directory\n").stderr

tests_recursive\test_steward_runner.py:243: AssertionError
____________ TestAT06NoChangeNoCommit.test_no_change_exits_success ____________

self = <tests_recursive.test_steward_runner.TestAT06NoChangeNoCommit object at 0x0000020586DCFBC0>
worktree = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_no_change_exits_success0/test_worktree')
test_config = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_no_change_exits_success0/test_worktree/config/test_runner.yaml')

    def test_no_change_exits_success(self, worktree: Path, test_config: Path):
        """Corpus runs, no changes \u2192 exit 0; no commit."""
        exit_code, log_file = run_steward(worktree, test_config, run_id="at06-test")
    
>       assert exit_code == 0, "Should succeed with no changes"
E       AssertionError: Should succeed with no changes
E       assert 2 == 0

tests_recursive\test_steward_runner.py:358: AssertionError
_____ TestAT07ChangeWithinAllowedPathsCommits.test_allowed_change_commits _____

self = <tests_recursive.test_steward_runner.TestAT07ChangeWithinAllowedPathsCommits object at 0x0000020586DCFE90>
worktree = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_allowed_change_commits0/test_worktree')
test_config = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_allowed_change_commits0/test_worktree/config/test_runner.yaml')

    def test_allowed_change_commits(self, worktree: Path, test_config: Path):
        """Corpus creates diff only within commit_paths \u2192 exactly one commit."""
        # Enable commit and create a change in allowed path
        config_content = test_config.read_text().replace(
            "commit_enabled: false",
            "commit_enabled: true"
        )
        # Make corpus create a file in docs/
        config_content = config_content.replace(
            'command: ["python", "-c", "print(\'corpus generated\')"]',
            'command: ["python", "-c", "import os; os.makedirs(\'docs\', exist_ok=True); open(\'docs/test.md\', \'w\').write(\'test\')"]'
        )
        config_content = config_content.replace(
            "commit_paths: [\"docs/\"]",
            'commit_paths: ["docs/"]'
        )
        test_config.write_text(config_content)
    
        # Commit the config change so only docs/ changes are uncommitted
        subprocess.run(["git", "add", "-A"], cwd=worktree, capture_output=True)
        subprocess.run(
            ["git", "commit", "-m", "[test] Update config for AT-07"],
            cwd=worktree,
            capture_output=True,
        )
    
        # Ensure docs dir exists
        (worktree / "docs").mkdir(exist_ok=True)
    
        head_before = subprocess.run(
            ["git", "rev-parse", "HEAD"],
            cwd=worktree,
            capture_output=True,
            text=True,
        ).stdout.strip()
    
        exit_code, log_file = run_steward(worktree, test_config, run_id="at07-test", commit=True)
    
        head_after = subprocess.run(
            ["git", "rev-parse", "HEAD"],
            cwd=worktree,
            capture_output=True,
            text=True,
        ).stdout.strip()
    
>       assert exit_code == 0, "Should succeed with allowed changes"
E       AssertionError: Should succeed with allowed changes
E       assert 2 == 0

tests_recursive\test_steward_runner.py:414: AssertionError
____________ TestAT09DryRunNeverCommits.test_dry_run_skips_commit _____________

self = <tests_recursive.test_steward_runner.TestAT09DryRunNeverCommits object at 0x0000020586DFC470>
worktree = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_dry_run_skips_commit0/test_worktree')
test_config = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_dry_run_skips_commit0/test_worktree/config/test_runner.yaml')

    def test_dry_run_skips_commit(self, worktree: Path, test_config: Path):
        """With allowable diff and --dry-run \u2192 exit 0; commit skipped."""
        # Enable commit and create allowed change
        config_content = test_config.read_text().replace(
            "commit_enabled: false",
            "commit_enabled: true"
        )
        config_content = config_content.replace(
            'command: ["python", "-c", "print(\'corpus generated\')"]',
            'command: ["python", "-c", "import os; os.makedirs(\'docs\', exist_ok=True); open(\'docs/test.md\', \'w\').write(\'test\')"]'
        )
        test_config.write_text(config_content)
    
        (worktree / "docs").mkdir(exist_ok=True)
    
        head_before = subprocess.run(
            ["git", "rev-parse", "HEAD"],
            cwd=worktree,
            capture_output=True,
            text=True,
        ).stdout.strip()
    
        # Run with --dry-run
        exit_code, log_file = run_steward(worktree, test_config, run_id="at09-test", dry_run=True)
    
        head_after = subprocess.run(
            ["git", "rev-parse", "HEAD"],
            cwd=worktree,
            capture_output=True,
            text=True,
        ).stdout.strip()
    
>       assert exit_code == 0, "Should succeed with dry-run"
E       AssertionError: Should succeed with dry-run
E       assert 2 == 0

tests_recursive\test_steward_runner.py:503: AssertionError
_____________ TestAT10LogDeterminism.test_logs_are_deterministic ______________

self = <tests_recursive.test_steward_runner.TestAT10LogDeterminism object at 0x0000020586DFC740>
worktree = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_logs_are_deterministic0/test_worktree')
test_config = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_logs_are_deterministic0/test_worktree/config/test_runner.yaml')

    def test_logs_are_deterministic(self, worktree: Path, test_config: Path):
        """Same repo state + same run_id \u2192 byte-identical JSONL."""
        run_id = "at10-determinism"
    
        # First run
        exit_code1, log_file1 = run_steward(worktree, test_config, run_id=run_id)
>       assert exit_code1 == 0
E       assert 2 == 0

tests_recursive\test_steward_runner.py:522: AssertionError
_________ TestAT11TestScopeEnforcement.test_tests_argv_includes_paths _________

self = <tests_recursive.test_steward_runner.TestAT11TestScopeEnforcement object at 0x0000020586DFC9E0>
worktree = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_tests_argv_includes_paths0/test_worktree')
test_config = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_tests_argv_includes_paths0/test_worktree/config/test_runner.yaml')

    def test_tests_argv_includes_paths(self, worktree: Path, test_config: Path):
        """tests.paths must appear in the tests step argv."""
        # Update config to have specific test paths
        config_content = test_config.read_text()
        config_content = config_content.replace(
            "paths: []",
            'paths: ["path_a", "path_b", "path_c"]'
        )
        test_config.write_text(config_content)
    
        # Commit config change
        subprocess.run(["git", "add", "-A"], cwd=worktree, capture_output=True)
        subprocess.run(
            ["git", "commit", "-m", "[test] Update config for AT-11"],
            cwd=worktree,
            capture_output=True,
        )
    
        exit_code, log_file = run_steward(worktree, test_config, run_id="at11-test")
    
        # Test passes or fails, but we need to check the argv
>       assert log_file is not None, "Should have log file"
E       AssertionError: Should have log file
E       assert None is not None

tests_recursive\test_steward_runner.py:563: AssertionError
_ TestAT13FailClosedUnsafePaths.test_unsafe_path_fails[../docs/-path_traversal] _

self = <tests_recursive.test_steward_runner.TestAT13FailClosedUnsafePaths object at 0x0000020586DFD010>
worktree = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_unsafe_path_fails____docs0/test_worktree')
test_config = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_unsafe_path_fails____docs0/test_worktree/config/test_runner.yaml')
unsafe_path = '../docs/', expected_error = 'path_traversal'

    @pytest.mark.parametrize("unsafe_path,expected_error", [
        ("../docs/", "path_traversal"),
        ("docs/../other/", "path_traversal"),
        ("docs/*.md", "glob_pattern"),
        ("docs/?.md", "glob_pattern"),
        ("C:/temp/", "absolute_path_windows"),
        ("C:\\temp\\", "absolute_path_windows"),
        ("/absolute/path/", "absolute_path_unix"),
        ("/absolute/path/", "absolute_path_unix"),
        ("//server/share/", "absolute_path_unc"),
        ("docs%2Ffolder", "url_encoded_chars"),  # P2-B
    ])
    def test_unsafe_path_fails(self, worktree: Path, test_config: Path, unsafe_path: str, expected_error: str):
        """Unsafe paths fail closed with clear error reason."""
        # Update config with unsafe path
        config_content = test_config.read_text()
        # Escape for YAML
        escaped_path = unsafe_path.replace("\\", "\\\\")
        config_content = config_content.replace(
            'commit_paths: ["docs/"]',
            f'commit_paths: ["{escaped_path}"]'
        )
        config_content = config_content.replace(
            "commit_enabled: false",
            "commit_enabled: true"
        )
        # Create a change so commit is attempted
        config_content = config_content.replace(
            'command: ["python", "-c", "print(\'corpus generated\')"]',
            'command: ["python", "-c", "import os; os.makedirs(\'docs\', exist_ok=True); open(\'docs/test.md\', \'w\').write(\'test\')"]'
        )
        test_config.write_text(config_content)
    
        (worktree / "docs").mkdir(exist_ok=True)
    
        (worktree / "docs").mkdir(exist_ok=True)
    
        exit_code, log_file = run_steward(worktree, test_config, run_id=f"at13-{expected_error}", commit=True)
    
        assert exit_code != 0, f"Should fail with unsafe path: {unsafe_path}"
>       assert log_file is not None
E       assert None is not None

tests_recursive\test_steward_runner.py:683: AssertionError
_ TestAT13FailClosedUnsafePaths.test_unsafe_path_fails[docs/../other/-path_traversal] _

self = <tests_recursive.test_steward_runner.TestAT13FailClosedUnsafePaths object at 0x0000020586DFD310>
worktree = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_unsafe_path_fails_docs___0/test_worktree')
test_config = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_unsafe_path_fails_docs___0/test_worktree/config/test_runner.yaml')
unsafe_path = 'docs/../other/', expected_error = 'path_traversal'

    @pytest.mark.parametrize("unsafe_path,expected_error", [
        ("../docs/", "path_traversal"),
        ("docs/../other/", "path_traversal"),
        ("docs/*.md", "glob_pattern"),
        ("docs/?.md", "glob_pattern"),
        ("C:/temp/", "absolute_path_windows"),
        ("C:\\temp\\", "absolute_path_windows"),
        ("/absolute/path/", "absolute_path_unix"),
        ("/absolute/path/", "absolute_path_unix"),
        ("//server/share/", "absolute_path_unc"),
        ("docs%2Ffolder", "url_encoded_chars"),  # P2-B
    ])
    def test_unsafe_path_fails(self, worktree: Path, test_config: Path, unsafe_path: str, expected_error: str):
        """Unsafe paths fail closed with clear error reason."""
        # Update config with unsafe path
        config_content = test_config.read_text()
        # Escape for YAML
        escaped_path = unsafe_path.replace("\\", "\\\\")
        config_content = config_content.replace(
            'commit_paths: ["docs/"]',
            f'commit_paths: ["{escaped_path}"]'
        )
        config_content = config_content.replace(
            "commit_enabled: false",
            "commit_enabled: true"
        )
        # Create a change so commit is attempted
        config_content = config_content.replace(
            'command: ["python", "-c", "print(\'corpus generated\')"]',
            'command: ["python", "-c", "import os; os.makedirs(\'docs\', exist_ok=True); open(\'docs/test.md\', \'w\').write(\'test\')"]'
        )
        test_config.write_text(config_content)
    
        (worktree / "docs").mkdir(exist_ok=True)
    
        (worktree / "docs").mkdir(exist_ok=True)
    
        exit_code, log_file = run_steward(worktree, test_config, run_id=f"at13-{expected_error}", commit=True)
    
        assert exit_code != 0, f"Should fail with unsafe path: {unsafe_path}"
>       assert log_file is not None
E       assert None is not None

tests_recursive\test_steward_runner.py:683: AssertionError
_ TestAT13FailClosedUnsafePaths.test_unsafe_path_fails[docs/*.md-glob_pattern] _

self = <tests_recursive.test_steward_runner.TestAT13FailClosedUnsafePaths object at 0x0000020586DFD3D0>
worktree = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_unsafe_path_fails_docs___1/test_worktree')
test_config = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_unsafe_path_fails_docs___1/test_worktree/config/test_runner.yaml')
unsafe_path = 'docs/*.md', expected_error = 'glob_pattern'

    @pytest.mark.parametrize("unsafe_path,expected_error", [
        ("../docs/", "path_traversal"),
        ("docs/../other/", "path_traversal"),
        ("docs/*.md", "glob_pattern"),
        ("docs/?.md", "glob_pattern"),
        ("C:/temp/", "absolute_path_windows"),
        ("C:\\temp\\", "absolute_path_windows"),
        ("/absolute/path/", "absolute_path_unix"),
        ("/absolute/path/", "absolute_path_unix"),
        ("//server/share/", "absolute_path_unc"),
        ("docs%2Ffolder", "url_encoded_chars"),  # P2-B
    ])
    def test_unsafe_path_fails(self, worktree: Path, test_config: Path, unsafe_path: str, expected_error: str):
        """Unsafe paths fail closed with clear error reason."""
        # Update config with unsafe path
        config_content = test_config.read_text()
        # Escape for YAML
        escaped_path = unsafe_path.replace("\\", "\\\\")
        config_content = config_content.replace(
            'commit_paths: ["docs/"]',
            f'commit_paths: ["{escaped_path}"]'
        )
        config_content = config_content.replace(
            "commit_enabled: false",
            "commit_enabled: true"
        )
        # Create a change so commit is attempted
        config_content = config_content.replace(
            'command: ["python", "-c", "print(\'corpus generated\')"]',
            'command: ["python", "-c", "import os; os.makedirs(\'docs\', exist_ok=True); open(\'docs/test.md\', \'w\').write(\'test\')"]'
        )
        test_config.write_text(config_content)
    
        (worktree / "docs").mkdir(exist_ok=True)
    
        (worktree / "docs").mkdir(exist_ok=True)
    
        exit_code, log_file = run_steward(worktree, test_config, run_id=f"at13-{expected_error}", commit=True)
    
        assert exit_code != 0, f"Should fail with unsafe path: {unsafe_path}"
>       assert log_file is not None
E       assert None is not None

tests_recursive\test_steward_runner.py:683: AssertionError
_ TestAT13FailClosedUnsafePaths.test_unsafe_path_fails[docs/?.md-glob_pattern] _

self = <tests_recursive.test_steward_runner.TestAT13FailClosedUnsafePaths object at 0x0000020586DCFCE0>
worktree = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_unsafe_path_fails_docs___2/test_worktree')
test_config = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_unsafe_path_fails_docs___2/test_worktree/config/test_runner.yaml')
unsafe_path = 'docs/?.md', expected_error = 'glob_pattern'

    @pytest.mark.parametrize("unsafe_path,expected_error", [
        ("../docs/", "path_traversal"),
        ("docs/../other/", "path_traversal"),
        ("docs/*.md", "glob_pattern"),
        ("docs/?.md", "glob_pattern"),
        ("C:/temp/", "absolute_path_windows"),
        ("C:\\temp\\", "absolute_path_windows"),
        ("/absolute/path/", "absolute_path_unix"),
        ("/absolute/path/", "absolute_path_unix"),
        ("//server/share/", "absolute_path_unc"),
        ("docs%2Ffolder", "url_encoded_chars"),  # P2-B
    ])
    def test_unsafe_path_fails(self, worktree: Path, test_config: Path, unsafe_path: str, expected_error: str):
        """Unsafe paths fail closed with clear error reason."""
        # Update config with unsafe path
        config_content = test_config.read_text()
        # Escape for YAML
        escaped_path = unsafe_path.replace("\\", "\\\\")
        config_content = config_content.replace(
            'commit_paths: ["docs/"]',
            f'commit_paths: ["{escaped_path}"]'
        )
        config_content = config_content.replace(
            "commit_enabled: false",
            "commit_enabled: true"
        )
        # Create a change so commit is attempted
        config_content = config_content.replace(
            'command: ["python", "-c", "print(\'corpus generated\')"]',
            'command: ["python", "-c", "import os; os.makedirs(\'docs\', exist_ok=True); open(\'docs/test.md\', \'w\').write(\'test\')"]'
        )
        test_config.write_text(config_content)
    
        (worktree / "docs").mkdir(exist_ok=True)
    
        (worktree / "docs").mkdir(exist_ok=True)
    
        exit_code, log_file = run_steward(worktree, test_config, run_id=f"at13-{expected_error}", commit=True)
    
        assert exit_code != 0, f"Should fail with unsafe path: {unsafe_path}"
>       assert log_file is not None
E       assert None is not None

tests_recursive\test_steward_runner.py:683: AssertionError
_ TestAT13FailClosedUnsafePaths.test_unsafe_path_fails[C:/temp/-absolute_path_windows] _

self = <tests_recursive.test_steward_runner.TestAT13FailClosedUnsafePaths object at 0x0000020586DCFA40>
worktree = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_unsafe_path_fails_C__temp0/test_worktree')
test_config = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_unsafe_path_fails_C__temp0/test_worktree/config/test_runner.yaml')
unsafe_path = 'C:/temp/', expected_error = 'absolute_path_windows'

    @pytest.mark.parametrize("unsafe_path,expected_error", [
        ("../docs/", "path_traversal"),
        ("docs/../other/", "path_traversal"),
        ("docs/*.md", "glob_pattern"),
        ("docs/?.md", "glob_pattern"),
        ("C:/temp/", "absolute_path_windows"),
        ("C:\\temp\\", "absolute_path_windows"),
        ("/absolute/path/", "absolute_path_unix"),
        ("/absolute/path/", "absolute_path_unix"),
        ("//server/share/", "absolute_path_unc"),
        ("docs%2Ffolder", "url_encoded_chars"),  # P2-B
    ])
    def test_unsafe_path_fails(self, worktree: Path, test_config: Path, unsafe_path: str, expected_error: str):
        """Unsafe paths fail closed with clear error reason."""
        # Update config with unsafe path
        config_content = test_config.read_text()
        # Escape for YAML
        escaped_path = unsafe_path.replace("\\", "\\\\")
        config_content = config_content.replace(
            'commit_paths: ["docs/"]',
            f'commit_paths: ["{escaped_path}"]'
        )
        config_content = config_content.replace(
            "commit_enabled: false",
            "commit_enabled: true"
        )
        # Create a change so commit is attempted
        config_content = config_content.replace(
            'command: ["python", "-c", "print(\'corpus generated\')"]',
            'command: ["python", "-c", "import os; os.makedirs(\'docs\', exist_ok=True); open(\'docs/test.md\', \'w\').write(\'test\')"]'
        )
        test_config.write_text(config_content)
    
        (worktree / "docs").mkdir(exist_ok=True)
    
        (worktree / "docs").mkdir(exist_ok=True)
    
        exit_code, log_file = run_steward(worktree, test_config, run_id=f"at13-{expected_error}", commit=True)
    
        assert exit_code != 0, f"Should fail with unsafe path: {unsafe_path}"
>       assert log_file is not None
E       assert None is not None

tests_recursive\test_steward_runner.py:683: AssertionError
_ TestAT13FailClosedUnsafePaths.test_unsafe_path_fails[C:\\temp\\-absolute_path_windows] _

self = <tests_recursive.test_steward_runner.TestAT13FailClosedUnsafePaths object at 0x0000020586DCF530>
worktree = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_unsafe_path_fails_C___tem0/test_worktree')
test_config = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_unsafe_path_fails_C___tem0/test_worktree/config/test_runner.yaml')
unsafe_path = 'C:\\temp\\', expected_error = 'absolute_path_windows'

    @pytest.mark.parametrize("unsafe_path,expected_error", [
        ("../docs/", "path_traversal"),
        ("docs/../other/", "path_traversal"),
        ("docs/*.md", "glob_pattern"),
        ("docs/?.md", "glob_pattern"),
        ("C:/temp/", "absolute_path_windows"),
        ("C:\\temp\\", "absolute_path_windows"),
        ("/absolute/path/", "absolute_path_unix"),
        ("/absolute/path/", "absolute_path_unix"),
        ("//server/share/", "absolute_path_unc"),
        ("docs%2Ffolder", "url_encoded_chars"),  # P2-B
    ])
    def test_unsafe_path_fails(self, worktree: Path, test_config: Path, unsafe_path: str, expected_error: str):
        """Unsafe paths fail closed with clear error reason."""
        # Update config with unsafe path
        config_content = test_config.read_text()
        # Escape for YAML
        escaped_path = unsafe_path.replace("\\", "\\\\")
        config_content = config_content.replace(
            'commit_paths: ["docs/"]',
            f'commit_paths: ["{escaped_path}"]'
        )
        config_content = config_content.replace(
            "commit_enabled: false",
            "commit_enabled: true"
        )
        # Create a change so commit is attempted
        config_content = config_content.replace(
            'command: ["python", "-c", "print(\'corpus generated\')"]',
            'command: ["python", "-c", "import os; os.makedirs(\'docs\', exist_ok=True); open(\'docs/test.md\', \'w\').write(\'test\')"]'
        )
        test_config.write_text(config_content)
    
        (worktree / "docs").mkdir(exist_ok=True)
    
        (worktree / "docs").mkdir(exist_ok=True)
    
        exit_code, log_file = run_steward(worktree, test_config, run_id=f"at13-{expected_error}", commit=True)
    
        assert exit_code != 0, f"Should fail with unsafe path: {unsafe_path}"
>       assert log_file is not None
E       assert None is not None

tests_recursive\test_steward_runner.py:683: AssertionError
_ TestAT13FailClosedUnsafePaths.test_unsafe_path_fails[/absolute/path/-absolute_path_unix0] _

self = <tests_recursive.test_steward_runner.TestAT13FailClosedUnsafePaths object at 0x0000020586DCF1D0>
worktree = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_unsafe_path_fails__absolu0/test_worktree')
test_config = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_unsafe_path_fails__absolu0/test_worktree/config/test_runner.yaml')
unsafe_path = '/absolute/path/', expected_error = 'absolute_path_unix'

    @pytest.mark.parametrize("unsafe_path,expected_error", [
        ("../docs/", "path_traversal"),
        ("docs/../other/", "path_traversal"),
        ("docs/*.md", "glob_pattern"),
        ("docs/?.md", "glob_pattern"),
        ("C:/temp/", "absolute_path_windows"),
        ("C:\\temp\\", "absolute_path_windows"),
        ("/absolute/path/", "absolute_path_unix"),
        ("/absolute/path/", "absolute_path_unix"),
        ("//server/share/", "absolute_path_unc"),
        ("docs%2Ffolder", "url_encoded_chars"),  # P2-B
    ])
    def test_unsafe_path_fails(self, worktree: Path, test_config: Path, unsafe_path: str, expected_error: str):
        """Unsafe paths fail closed with clear error reason."""
        # Update config with unsafe path
        config_content = test_config.read_text()
        # Escape for YAML
        escaped_path = unsafe_path.replace("\\", "\\\\")
        config_content = config_content.replace(
            'commit_paths: ["docs/"]',
            f'commit_paths: ["{escaped_path}"]'
        )
        config_content = config_content.replace(
            "commit_enabled: false",
            "commit_enabled: true"
        )
        # Create a change so commit is attempted
        config_content = config_content.replace(
            'command: ["python", "-c", "print(\'corpus generated\')"]',
            'command: ["python", "-c", "import os; os.makedirs(\'docs\', exist_ok=True); open(\'docs/test.md\', \'w\').write(\'test\')"]'
        )
        test_config.write_text(config_content)
    
        (worktree / "docs").mkdir(exist_ok=True)
    
        (worktree / "docs").mkdir(exist_ok=True)
    
        exit_code, log_file = run_steward(worktree, test_config, run_id=f"at13-{expected_error}", commit=True)
    
        assert exit_code != 0, f"Should fail with unsafe path: {unsafe_path}"
>       assert log_file is not None
E       assert None is not None

tests_recursive\test_steward_runner.py:683: AssertionError
_ TestAT13FailClosedUnsafePaths.test_unsafe_path_fails[/absolute/path/-absolute_path_unix1] _

self = <tests_recursive.test_steward_runner.TestAT13FailClosedUnsafePaths object at 0x0000020586DCEF30>
worktree = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_unsafe_path_fails__absolu1/test_worktree')
test_config = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_unsafe_path_fails__absolu1/test_worktree/config/test_runner.yaml')
unsafe_path = '/absolute/path/', expected_error = 'absolute_path_unix'

    @pytest.mark.parametrize("unsafe_path,expected_error", [
        ("../docs/", "path_traversal"),
        ("docs/../other/", "path_traversal"),
        ("docs/*.md", "glob_pattern"),
        ("docs/?.md", "glob_pattern"),
        ("C:/temp/", "absolute_path_windows"),
        ("C:\\temp\\", "absolute_path_windows"),
        ("/absolute/path/", "absolute_path_unix"),
        ("/absolute/path/", "absolute_path_unix"),
        ("//server/share/", "absolute_path_unc"),
        ("docs%2Ffolder", "url_encoded_chars"),  # P2-B
    ])
    def test_unsafe_path_fails(self, worktree: Path, test_config: Path, unsafe_path: str, expected_error: str):
        """Unsafe paths fail closed with clear error reason."""
        # Update config with unsafe path
        config_content = test_config.read_text()
        # Escape for YAML
        escaped_path = unsafe_path.replace("\\", "\\\\")
        config_content = config_content.replace(
            'commit_paths: ["docs/"]',
            f'commit_paths: ["{escaped_path}"]'
        )
        config_content = config_content.replace(
            "commit_enabled: false",
            "commit_enabled: true"
        )
        # Create a change so commit is attempted
        config_content = config_content.replace(
            'command: ["python", "-c", "print(\'corpus generated\')"]',
            'command: ["python", "-c", "import os; os.makedirs(\'docs\', exist_ok=True); open(\'docs/test.md\', \'w\').write(\'test\')"]'
        )
        test_config.write_text(config_content)
    
        (worktree / "docs").mkdir(exist_ok=True)
    
        (worktree / "docs").mkdir(exist_ok=True)
    
        exit_code, log_file = run_steward(worktree, test_config, run_id=f"at13-{expected_error}", commit=True)
    
        assert exit_code != 0, f"Should fail with unsafe path: {unsafe_path}"
>       assert log_file is not None
E       assert None is not None

tests_recursive\test_steward_runner.py:683: AssertionError
_ TestAT13FailClosedUnsafePaths.test_unsafe_path_fails[//server/share/-absolute_path_unc] _

self = <tests_recursive.test_steward_runner.TestAT13FailClosedUnsafePaths object at 0x0000020586DFCFB0>
worktree = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_unsafe_path_fails___serve0/test_worktree')
test_config = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_unsafe_path_fails___serve0/test_worktree/config/test_runner.yaml')
unsafe_path = '//server/share/', expected_error = 'absolute_path_unc'

    @pytest.mark.parametrize("unsafe_path,expected_error", [
        ("../docs/", "path_traversal"),
        ("docs/../other/", "path_traversal"),
        ("docs/*.md", "glob_pattern"),
        ("docs/?.md", "glob_pattern"),
        ("C:/temp/", "absolute_path_windows"),
        ("C:\\temp\\", "absolute_path_windows"),
        ("/absolute/path/", "absolute_path_unix"),
        ("/absolute/path/", "absolute_path_unix"),
        ("//server/share/", "absolute_path_unc"),
        ("docs%2Ffolder", "url_encoded_chars"),  # P2-B
    ])
    def test_unsafe_path_fails(self, worktree: Path, test_config: Path, unsafe_path: str, expected_error: str):
        """Unsafe paths fail closed with clear error reason."""
        # Update config with unsafe path
        config_content = test_config.read_text()
        # Escape for YAML
        escaped_path = unsafe_path.replace("\\", "\\\\")
        config_content = config_content.replace(
            'commit_paths: ["docs/"]',
            f'commit_paths: ["{escaped_path}"]'
        )
        config_content = config_content.replace(
            "commit_enabled: false",
            "commit_enabled: true"
        )
        # Create a change so commit is attempted
        config_content = config_content.replace(
            'command: ["python", "-c", "print(\'corpus generated\')"]',
            'command: ["python", "-c", "import os; os.makedirs(\'docs\', exist_ok=True); open(\'docs/test.md\', \'w\').write(\'test\')"]'
        )
        test_config.write_text(config_content)
    
        (worktree / "docs").mkdir(exist_ok=True)
    
        (worktree / "docs").mkdir(exist_ok=True)
    
        exit_code, log_file = run_steward(worktree, test_config, run_id=f"at13-{expected_error}", commit=True)
    
        assert exit_code != 0, f"Should fail with unsafe path: {unsafe_path}"
>       assert log_file is not None
E       assert None is not None

tests_recursive\test_steward_runner.py:683: AssertionError
_ TestAT13FailClosedUnsafePaths.test_unsafe_path_fails[docs%2Ffolder-url_encoded_chars] _

self = <tests_recursive.test_steward_runner.TestAT13FailClosedUnsafePaths object at 0x0000020586DFCB30>
worktree = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_unsafe_path_fails_docs_2F0/test_worktree')
test_config = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_unsafe_path_fails_docs_2F0/test_worktree/config/test_runner.yaml')
unsafe_path = 'docs%2Ffolder', expected_error = 'url_encoded_chars'

    @pytest.mark.parametrize("unsafe_path,expected_error", [
        ("../docs/", "path_traversal"),
        ("docs/../other/", "path_traversal"),
        ("docs/*.md", "glob_pattern"),
        ("docs/?.md", "glob_pattern"),
        ("C:/temp/", "absolute_path_windows"),
        ("C:\\temp\\", "absolute_path_windows"),
        ("/absolute/path/", "absolute_path_unix"),
        ("/absolute/path/", "absolute_path_unix"),
        ("//server/share/", "absolute_path_unc"),
        ("docs%2Ffolder", "url_encoded_chars"),  # P2-B
    ])
    def test_unsafe_path_fails(self, worktree: Path, test_config: Path, unsafe_path: str, expected_error: str):
        """Unsafe paths fail closed with clear error reason."""
        # Update config with unsafe path
        config_content = test_config.read_text()
        # Escape for YAML
        escaped_path = unsafe_path.replace("\\", "\\\\")
        config_content = config_content.replace(
            'commit_paths: ["docs/"]',
            f'commit_paths: ["{escaped_path}"]'
        )
        config_content = config_content.replace(
            "commit_enabled: false",
            "commit_enabled: true"
        )
        # Create a change so commit is attempted
        config_content = config_content.replace(
            'command: ["python", "-c", "print(\'corpus generated\')"]',
            'command: ["python", "-c", "import os; os.makedirs(\'docs\', exist_ok=True); open(\'docs/test.md\', \'w\').write(\'test\')"]'
        )
        test_config.write_text(config_content)
    
        (worktree / "docs").mkdir(exist_ok=True)
    
        (worktree / "docs").mkdir(exist_ok=True)
    
        exit_code, log_file = run_steward(worktree, test_config, run_id=f"at13-{expected_error}", commit=True)
    
        assert exit_code != 0, f"Should fail with unsafe path: {unsafe_path}"
>       assert log_file is not None
E       assert None is not None

tests_recursive\test_steward_runner.py:683: AssertionError
____________ TestAT14DirtyDuringRun.test_dirty_during_run_rejected ____________

self = <tests_recursive.test_steward_runner.TestAT14DirtyDuringRun object at 0x0000020586DFD4C0>
worktree = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_dirty_during_run_rejected0/test_worktree')
test_config = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_dirty_during_run_rejected0/test_worktree/config/test_runner.yaml')

    def test_dirty_during_run_rejected(self, worktree: Path, test_config: Path):
        """
        Simulate race condition where repo becomes dirty between change_detect and commit.
    
        Since existing tests use subprocess which makes patching hard, this test
        dynamically loads the runner module and tests run_commit directly.
        """
        # Load steward_runner module dynamically
        runner_path = worktree / "scripts" / "steward_runner.py"
        spec = importlib.util.spec_from_file_location("steward_runner", runner_path)
        runner_module = importlib.util.module_from_spec(spec)
>       spec.loader.exec_module(runner_module)

tests_recursive\test_steward_runner.py:706: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<frozen importlib._bootstrap_external>:991: in exec_module
    ???
<frozen importlib._bootstrap_external>:1128: in get_code
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <_frozen_importlib_external.SourceFileLoader object at 0x0000020586EEAFF0>
path = 'C:\\Users\\cabra\\AppData\\Local\\Temp\\pytest-of-cabra\\pytest-363\\test_dirty_during_run_rejected0\\test_worktree\\scripts\\steward_runner.py'

>   ???
E   FileNotFoundError: [Errno 2] No such file or directory: 'C:\\Users\\cabra\\AppData\\Local\\Temp\\pytest-of-cabra\\pytest-363\\test_dirty_during_run_rejected0\\test_worktree\\scripts\\steward_runner.py'

<frozen importlib._bootstrap_external>:1186: FileNotFoundError
______________ TestAT15LogFieldSorting.test_log_lists_are_sorted ______________

self = <tests_recursive.test_steward_runner.TestAT15LogFieldSorting object at 0x0000020586DFD790>
worktree = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_log_lists_are_sorted0/test_worktree')
test_config = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_log_lists_are_sorted0/test_worktree/config/test_runner.yaml')

    def test_log_lists_are_sorted(self, worktree: Path, test_config: Path):
        """File lists in logs must be sorted lexicographically."""
        # Create files in unsorted order
        (worktree / "docs").mkdir(exist_ok=True)
        filenames = ["z_file.md", "a_file.md", "m_file.md"]
        for name in filenames:
            (worktree / "docs" / name).write_text("test")
    
        # Add them so they show up in changed_files (if committed, verify validated/staged)
        # We need commit_enabled=True to check staged_files/commit_paths
        config_content = test_config.read_text().replace(
            "commit_enabled: false",
            "commit_enabled: true"
        )
        test_config.write_text(config_content)
    
        # We need to make them dirty first (change_detect)
        # But for 'staged_files' inside commit event, they need to be valid
        # Let's clean worktree first then modify them?
        # fixture creates clean worktree.
        # newly created files are untracked.
    
        exit_code, log_file = run_steward(worktree, test_config, run_id="at15-test", dry_run=True)
>       assert exit_code == 0
E       assert 2 == 0

tests_recursive\test_steward_runner.py:769: AssertionError
_______________ TestAT16DefaultDryRun.test_no_flags_is_dry_run ________________

self = <tests_recursive.test_steward_runner.TestAT16DefaultDryRun object at 0x0000020586DFDA60>
worktree = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_no_flags_is_dry_run0/test_worktree')
test_config = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_no_flags_is_dry_run0/test_worktree/config/test_runner.yaml')

    def test_no_flags_is_dry_run(self, worktree: Path, test_config: Path):
        """Run without flags -> dry run, no commit."""
        # Enable commit in config, but CLI default should override
        config_content = test_config.read_text().replace(
            "commit_enabled: false",
            "commit_enabled: true"
        )
        config_content = config_content.replace(
            'command: ["python", "-c", "print(\'corpus generated\')"]',
            'command: ["python", "-c", "import os; os.makedirs(\'docs\', exist_ok=True); open(\'docs/test.md\', \'w\').write(\'test\')"]'
        )
        test_config.write_text(config_content)
    
        # Don't pass dry_run=True, leave as default
        # But run_steward helper might need adjustment or allow None
        runner_path = worktree / "scripts" / "steward_runner.py"
    
        # Manual run without helper to ensure no flags
        result = subprocess.run(
            ["python", str(runner_path), "--config", str(test_config.relative_to(worktree)), "--run-id", "at16"],
            cwd=worktree,
            capture_output=True,
            text=True,
        )
>       assert result.returncode == 0
E       assert 2 == 0
E        +  where 2 = CompletedProcess(args=['python', 'C:\\Users\\cabra\\AppData\\Local\\Temp\\pytest-of-cabra\\pytest-363\\test_no_flags_is_dry_run0\\test_worktree\\scripts\\steward_runner.py', '--config', 'config\\test_runner.yaml', '--run-id', 'at16'], returncode=2, stdout='', stderr="python: can't open file 'C:\\\\Users\\\\cabra\\\\AppData\\\\Local\\\\Temp\\\\pytest-of-cabra\\\\pytest-363\\\\test_no_flags_is_dry_run0\\\\test_worktree\\\\scripts\\\\steward_runner.py': [Errno 2] No such file or directory\n").returncode

tests_recursive\test_steward_runner.py:812: AssertionError
_____________ TestAT17CommitFlagEnables.test_commit_flag_enables ______________

self = <tests_recursive.test_steward_runner.TestAT17CommitFlagEnables object at 0x0000020586DFDB50>
worktree = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_commit_flag_enables0/test_worktree')
test_config = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_commit_flag_enables0/test_worktree/config/test_runner.yaml')

    def test_commit_flag_enables(self, worktree: Path, test_config: Path):
        """Run with --commit -> commit happens."""
        config_content = test_config.read_text().replace(
            "commit_enabled: false",
            "commit_enabled: true"
        )
        config_content = config_content.replace(
            'command: ["python", "-c", "print(\'corpus generated\')"]',
            'command: ["python", "-c", "import os; os.makedirs(\'docs\', exist_ok=True); open(\'docs/test.md\', \'w\').write(\'test\')"]'
        )
        test_config.write_text(config_content)
    
        # Commit config change so only docs/ changes are uncommitted
        subprocess.run(["git", "add", "-A"], cwd=worktree, capture_output=True)
        subprocess.run(
            ["git", "commit", "-m", "[test] AT-17 config"],
            cwd=worktree,
            capture_output=True,
        )
    
        # Pass --commit
        exit_code, log_file = run_steward(worktree, test_config, run_id="at17", commit=True)
>       assert exit_code == 0
E       assert 2 == 0

tests_recursive\test_steward_runner.py:849: AssertionError
________________ TestAT18ExplicitDryRun.test_explicit_dry_run _________________

self = <tests_recursive.test_steward_runner.TestAT18ExplicitDryRun object at 0x0000020586DFDFD0>
worktree = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_explicit_dry_run0/test_worktree')
test_config = WindowsPath('C:/Users/cabra/AppData/Local/Temp/pytest-of-cabra/pytest-363/test_explicit_dry_run0/test_worktree/config/test_runner.yaml')

    def test_explicit_dry_run(self, worktree: Path, test_config: Path):
        """Run with --dry-run -> no commit."""
        # Same setup
        config_content = test_config.read_text().replace(
            "commit_enabled: false",
            "commit_enabled: true"
        )
        config_content = config_content.replace(
            'command: ["python", "-c", "print(\'corpus generated\')"]',
            'command: ["python", "-c", "import os; os.makedirs(\'docs\', exist_ok=True); open(\'docs/test.md\', \'w\').write(\'test\')"]'
        )
        test_config.write_text(config_content)
    
        runner_path = worktree / "scripts" / "steward_runner.py"
    
        # Pass --dry-run
        result = subprocess.run(
            ["python", str(runner_path), "--config", str(test_config.relative_to(worktree)), "--run-id", "at18", "--dry-run"],
            cwd=worktree,
            capture_output=True,
            text=True,
        )
>       assert result.returncode == 0
E       assert 2 == 0
E        +  where 2 = CompletedProcess(args=['python', 'C:\\Users\\cabra\\AppData\\Local\\Temp\\pytest-of-cabra\\pytest-363\\test_explicit_dry_run0\\test_worktree\\scripts\\steward_runner.py', '--config', 'config\\test_runner.yaml', '--run-id', 'at18', '--dry-run'], returncode=2, stdout='', stderr="python: can't open file 'C:\\\\Users\\\\cabra\\\\AppData\\\\Local\\\\Temp\\\\pytest-of-cabra\\\\pytest-363\\\\test_explicit_dry_run0\\\\test_worktree\\\\scripts\\\\steward_runner.py': [Errno 2] No such file or directory\n").returncode

tests_recursive\test_steward_runner.py:889: AssertionError
============================== warnings summary ===============================
runtime\orchestration\test_run.py:32
  C:\Users\cabra\Projects\LifeOS\runtime\orchestration\test_run.py:32: PytestCollectionWarning: cannot collect test class 'TestRunResult' because it has a __init__ constructor (from: runtime/tests/test_tier2_config_test_run.py)
    @dataclass(frozen=True)

runtime\orchestration\test_run.py:32
  C:\Users\cabra\Projects\LifeOS\runtime\orchestration\test_run.py:32: PytestCollectionWarning: cannot collect test class 'TestRunResult' because it has a __init__ constructor (from: runtime/tests/test_tier2_test_run.py)
    @dataclass(frozen=True)

runtime/tests/test_backpressure.py::test_backpressure_pause
  C:\Users\cabra\Projects\LifeOS\project_builder\orchestrator\missions.py:73: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    {'total_pending': total_pending, 'limit': max_pending}, datetime.utcnow())

runtime/tests/test_backpressure.py: 2 warnings
runtime/tests/test_fsm.py: 5 warnings
runtime/tests/test_reclaim.py: 2 warnings
runtime/tests/test_routing.py: 4 warnings
runtime/tests/test_tokenizer_replay.py: 2 warnings
  C:\Users\cabra\Projects\LifeOS\project_builder\database\timeline.py:48: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    conn.execute("""

runtime/tests/test_backpressure.py::test_backpressure_resume
  C:\Users\cabra\Projects\LifeOS\project_builder\orchestrator\missions.py:96: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    {'total_pending': total_pending, 'threshold': resume_threshold}, datetime.utcnow())

runtime/tests/test_fsm.py::test_start_task_execution
runtime/tests/test_fsm.py::test_start_task_execution
runtime/tests/test_fsm.py::test_transition_to_failed_terminal
runtime/tests/test_fsm.py::test_transition_to_failed_terminal
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_fsm.py:12: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    ("m1", "executing", "desc", 10.0, 5, datetime.utcnow(), datetime.utcnow()))

runtime/tests/test_fsm.py::test_start_task_execution
runtime/tests/test_fsm.py::test_start_task_execution
runtime/tests/test_fsm.py::test_transition_to_failed_terminal
runtime/tests/test_fsm.py::test_transition_to_failed_terminal
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_fsm.py:11: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    conn.execute("INSERT INTO missions (id, status, description, max_cost_usd, max_loops, created_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?)",

runtime/tests/test_fsm.py::test_start_task_execution
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_fsm.py:20: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    now = datetime.utcnow()

runtime/tests/test_fsm.py::test_start_task_execution
runtime/tests/test_tokenizer_replay.py::test_tokenizer_persistence_and_replay
runtime/tests/test_tokenizer_replay.py::test_tokenizer_persistence_and_replay
  C:\Users\cabra\Projects\LifeOS\project_builder\orchestrator\fsm.py:41: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    cur.execute("""

runtime/tests/test_fsm.py::test_start_task_execution
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_fsm.py:23: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    now = datetime.utcnow()

runtime/tests/test_fsm.py::test_start_task_execution
  C:\Users\cabra\Projects\LifeOS\project_builder\orchestrator\fsm.py:122: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    cur.execute("""

runtime/tests/test_fsm.py::test_transition_to_failed_terminal
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_fsm.py:38: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    now = datetime.utcnow()

runtime/tests/test_fsm.py::test_transition_to_failed_terminal
  C:\Users\cabra\Projects\LifeOS\project_builder\orchestrator\fsm.py:152: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    cur.execute("""

runtime/tests/test_fsm.py::test_transition_to_failed_terminal
  C:\Users\cabra\Projects\LifeOS\project_builder\orchestrator\fsm.py:163: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    cur.execute("""

runtime/tests/test_fsm.py::test_transition_to_failed_terminal
  C:\Users\cabra\Projects\LifeOS\project_builder\orchestrator\fsm.py:173: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    cur.execute("""

runtime/tests/test_missions_phase3.py::TestEngineMissionDispatch::test_design_mission_via_registry
  C:\Users\cabra\Projects\LifeOS\runtime\agents\api.py:173: UserWarning: Governance baseline missing at config\governance_baseline.yaml. Role prompt hash verification skipped.
    warnings.warn(

runtime/tests/test_opencode_client.py::TestServerState::test_call_without_server_raises
  C:\Users\cabra\Projects\LifeOS\runtime\agents\opencode_client.py:412: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    timestamp = datetime.utcnow().isoformat() + "Z"

runtime/tests/test_reclaim.py::test_reclaim_success
runtime/tests/test_reclaim.py::test_reclaim_success
runtime/tests/test_reclaim.py::test_reclaim_skipped_alive
runtime/tests/test_reclaim.py::test_reclaim_skipped_alive
runtime/tests/test_reclaim.py::test_reclaim_not_stale
runtime/tests/test_reclaim.py::test_reclaim_not_stale
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_reclaim.py:19: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    ("m1", "executing", "desc", 10.0, 5, datetime.utcnow(), datetime.utcnow()))

runtime/tests/test_reclaim.py::test_reclaim_success
runtime/tests/test_reclaim.py::test_reclaim_success
runtime/tests/test_reclaim.py::test_reclaim_skipped_alive
runtime/tests/test_reclaim.py::test_reclaim_skipped_alive
runtime/tests/test_reclaim.py::test_reclaim_not_stale
runtime/tests/test_reclaim.py::test_reclaim_not_stale
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_reclaim.py:18: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    conn.execute("INSERT INTO missions (id, status, description, max_cost_usd, max_loops, created_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?)",

runtime/tests/test_reclaim.py::test_reclaim_success
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_reclaim.py:26: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    stale_time = datetime.utcnow() - timedelta(seconds=TASK_LOCK_TIMEOUT_SECONDS + 10)

runtime/tests/test_reclaim.py::test_reclaim_success
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_reclaim.py:27: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    db_conn.execute("INSERT INTO mission_tasks (id, mission_id, task_order, description, status, locked_at, locked_by) VALUES (?, ?, ?, ?, ?, ?, ?)",

runtime/tests/test_reclaim.py::test_reclaim_success
runtime/tests/test_reclaim.py::test_reclaim_skipped_alive
runtime/tests/test_reclaim.py::test_reclaim_not_stale
  C:\Users\cabra\Projects\LifeOS\project_builder\orchestrator\reclaim.py:56: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    if datetime.utcnow() - locked_at_dt < timedelta(seconds=TASK_LOCK_TIMEOUT_SECONDS):

runtime/tests/test_reclaim.py::test_reclaim_success
  C:\Users\cabra\Projects\LifeOS\project_builder\orchestrator\reclaim.py:82: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    log_event(conn, mission_id, task_id, 'task_reclaimed', {}, datetime.utcnow())

runtime/tests/test_reclaim.py::test_reclaim_skipped_alive
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_reclaim.py:46: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    stale_time = datetime.utcnow() - timedelta(seconds=TASK_LOCK_TIMEOUT_SECONDS + 10)

runtime/tests/test_reclaim.py::test_reclaim_skipped_alive
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_reclaim.py:47: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    db_conn.execute("INSERT INTO mission_tasks (id, mission_id, task_order, description, status, locked_at, locked_by) VALUES (?, ?, ?, ?, ?, ?, ?)",

runtime/tests/test_reclaim.py::test_reclaim_skipped_alive
  C:\Users\cabra\Projects\LifeOS\project_builder\orchestrator\reclaim.py:68: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    log_task_reclaim_skipped_alive_or_unknown(conn, mission_id, task_id, str(locked_by), datetime.utcnow())

runtime/tests/test_reclaim.py::test_reclaim_not_stale
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_reclaim.py:63: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    fresh_time = datetime.utcnow()

runtime/tests/test_reclaim.py::test_reclaim_not_stale
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_reclaim.py:64: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    db_conn.execute("INSERT INTO mission_tasks (id, mission_id, task_order, description, status, locked_at, locked_by) VALUES (?, ?, ?, ?, ?, ?, ?)",

runtime/tests/test_routing.py::test_allowed_routes
runtime/tests/test_routing.py::test_allowed_routes
runtime/tests/test_routing.py::test_illegal_routes
runtime/tests/test_routing.py::test_illegal_routes
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_routing.py:12: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    ("m1", "executing", "desc", 10.0, 5, datetime.utcnow(), datetime.utcnow()))

runtime/tests/test_routing.py::test_allowed_routes
runtime/tests/test_routing.py::test_allowed_routes
runtime/tests/test_routing.py::test_illegal_routes
runtime/tests/test_routing.py::test_illegal_routes
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_routing.py:11: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    conn.execute("INSERT INTO missions (id, status, description, max_cost_usd, max_loops, created_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?)",

runtime/tests/test_routing.py::test_illegal_routes
runtime/tests/test_routing.py::test_illegal_routes
runtime/tests/test_routing.py::test_illegal_routes
runtime/tests/test_routing.py::test_illegal_routes
  C:\Users\cabra\Projects\LifeOS\project_builder\orchestrator\routing.py:30: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    {'from': from_agent, 'to': to_agent}, datetime.utcnow())

runtime/tests/test_snapshot.py::test_snapshot_basic
runtime/tests/test_snapshot.py::test_snapshot_basic
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:22: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    (mid, "executing", "desc", 10.0, 5, datetime.utcnow(), datetime.utcnow()))

runtime/tests/test_snapshot.py::test_snapshot_basic
runtime/tests/test_snapshot.py::test_snapshot_basic
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:21: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    db_conn.execute("INSERT INTO missions (id, status, description, max_cost_usd, max_loops, created_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?)",

runtime/tests/test_snapshot.py::test_snapshot_basic
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:24: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    started_at = datetime.utcnow()

runtime/tests/test_snapshot.py::test_snapshot_basic
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:26: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    (tid, mid, 1, "task1", "executing", started_at, datetime.utcnow()))

runtime/tests/test_snapshot.py::test_snapshot_basic
runtime/tests/test_snapshot.py::test_snapshot_basic
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:25: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    db_conn.execute("INSERT INTO mission_tasks (id, mission_id, task_order, description, status, started_at, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)",

runtime/tests/test_snapshot.py::test_snapshot_basic
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:29: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    db_conn.execute("""

runtime/tests/test_snapshot.py::test_snapshot_versioning
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:44: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    started_at = datetime.utcnow()

runtime/tests/test_snapshot.py::test_snapshot_versioning
runtime/tests/test_snapshot.py::test_snapshot_versioning
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:48: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    (mid, "executing", "desc", 10.0, 5, datetime.utcnow(), datetime.utcnow()))

runtime/tests/test_snapshot.py::test_snapshot_versioning
runtime/tests/test_snapshot.py::test_snapshot_versioning
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:47: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    db_conn.execute("INSERT INTO missions (id, status, description, max_cost_usd, max_loops, created_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?)",

runtime/tests/test_snapshot.py::test_snapshot_versioning
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:50: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    (tid, mid, 1, "task1", "executing", started_at, datetime.utcnow()))

runtime/tests/test_snapshot.py::test_snapshot_versioning
runtime/tests/test_snapshot.py::test_snapshot_versioning
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:49: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    db_conn.execute("INSERT INTO mission_tasks (id, mission_id, task_order, description, status, started_at, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)",

runtime/tests/test_snapshot.py::test_snapshot_versioning
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:53: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    db_conn.execute("""

runtime/tests/test_snapshot.py::test_snapshot_versioning
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:59: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    db_conn.execute("""

runtime/tests/test_snapshot.py::test_snapshot_tombstone
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:74: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    started_at = datetime.utcnow()

runtime/tests/test_snapshot.py::test_snapshot_tombstone
runtime/tests/test_snapshot.py::test_snapshot_tombstone
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:78: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    (mid, "executing", "desc", 10.0, 5, datetime.utcnow(), datetime.utcnow()))

runtime/tests/test_snapshot.py::test_snapshot_tombstone
runtime/tests/test_snapshot.py::test_snapshot_tombstone
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:77: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    db_conn.execute("INSERT INTO missions (id, status, description, max_cost_usd, max_loops, created_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?)",

runtime/tests/test_snapshot.py::test_snapshot_tombstone
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:80: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    (tid, mid, 1, "task1", "executing", started_at, datetime.utcnow()))

runtime/tests/test_snapshot.py::test_snapshot_tombstone
runtime/tests/test_snapshot.py::test_snapshot_tombstone
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:79: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    db_conn.execute("INSERT INTO mission_tasks (id, mission_id, task_order, description, status, started_at, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)",

runtime/tests/test_snapshot.py::test_snapshot_tombstone
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:83: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    db_conn.execute("""

runtime/tests/test_snapshot.py::test_snapshot_tombstone
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:89: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    db_conn.execute("""

runtime/tests/test_snapshot.py::test_snapshot_required_artifact_override
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:102: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    started_at = datetime.utcnow()

runtime/tests/test_snapshot.py::test_snapshot_required_artifact_override
runtime/tests/test_snapshot.py::test_snapshot_required_artifact_override
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:106: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    (mid, "executing", "desc", 10.0, 5, datetime.utcnow(), datetime.utcnow()))

runtime/tests/test_snapshot.py::test_snapshot_required_artifact_override
runtime/tests/test_snapshot.py::test_snapshot_required_artifact_override
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:105: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    db_conn.execute("INSERT INTO missions (id, status, description, max_cost_usd, max_loops, created_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?)",

runtime/tests/test_snapshot.py::test_snapshot_required_artifact_override
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:108: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    (tid, mid, 1, "task1", "executing", started_at, datetime.utcnow(), json.dumps(["a1"])))

runtime/tests/test_snapshot.py::test_snapshot_required_artifact_override
runtime/tests/test_snapshot.py::test_snapshot_required_artifact_override
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:107: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    db_conn.execute("INSERT INTO mission_tasks (id, mission_id, task_order, description, status, started_at, created_at, required_artifact_ids) VALUES (?, ?, ?, ?, ?, ?, ?, ?)",

runtime/tests/test_snapshot.py::test_snapshot_required_artifact_override
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:111: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    db_conn.execute("""

runtime/tests/test_snapshot.py::test_snapshot_required_artifact_override
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:117: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    db_conn.execute("""

runtime/tests/test_snapshot.py::test_snapshot_ordering
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:135: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    started_at = datetime.utcnow()

runtime/tests/test_snapshot.py::test_snapshot_ordering
runtime/tests/test_snapshot.py::test_snapshot_ordering
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:139: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    (mid, "executing", "desc", 10.0, 5, datetime.utcnow(), datetime.utcnow()))

runtime/tests/test_snapshot.py::test_snapshot_ordering
runtime/tests/test_snapshot.py::test_snapshot_ordering
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:138: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    db_conn.execute("INSERT INTO missions (id, status, description, max_cost_usd, max_loops, created_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?)",

runtime/tests/test_snapshot.py::test_snapshot_ordering
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:141: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    (tid, mid, 1, "task1", "executing", started_at, datetime.utcnow()))

runtime/tests/test_snapshot.py::test_snapshot_ordering
runtime/tests/test_snapshot.py::test_snapshot_ordering
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:140: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    db_conn.execute("INSERT INTO mission_tasks (id, mission_id, task_order, description, status, started_at, created_at) VALUES (?, ?, ?, ?, ?, ?, ?)",

runtime/tests/test_snapshot.py::test_snapshot_ordering
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:144: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    db_conn.execute("""

runtime/tests/test_snapshot.py::test_snapshot_ordering
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_snapshot.py:150: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    db_conn.execute("""

runtime/tests/test_tokenizer_replay.py::test_tokenizer_persistence_and_replay
runtime/tests/test_tokenizer_replay.py::test_tokenizer_persistence_and_replay
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_tokenizer_replay.py:79: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    ("m1", "executing", "desc", 10.0, 5, datetime.utcnow(), datetime.utcnow()))

runtime/tests/test_tokenizer_replay.py::test_tokenizer_persistence_and_replay
runtime/tests/test_tokenizer_replay.py::test_tokenizer_persistence_and_replay
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_tokenizer_replay.py:78: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    conn.execute("INSERT INTO missions (id, status, description, max_cost_usd, max_loops, created_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?)",

runtime/tests/test_tokenizer_replay.py::test_tokenizer_persistence_and_replay
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_tokenizer_replay.py:88: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    start_task_execution(db_conn, "m1", "t1", "tokenizer_A", datetime.utcnow())

runtime/tests/test_tokenizer_replay.py::test_tokenizer_persistence_and_replay
  c:\Users\cabra\Projects\LifeOS\runtime\tests\test_tokenizer_replay.py:100: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    start_task_execution(db_conn, "m1", "t1", "tokenizer_B", datetime.utcnow())

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
FAILED runtime/tests/test_opencode_client.py::TestLLMCall::test_llm_call_default_model
FAILED runtime/tests/test_opencode_client.py::TestServerState::test_call_without_server_raises
FAILED runtime/tests/test_opencode_client.py::TestImports::test_import_from_agents_package
FAILED runtime/tests/test_opencode_client.py::TestImports::test_all_exports
FAILED runtime/tests/test_opencode_governance/test_phase1_contract.py::test_t5_canonical_evidence_capture
FAILED tests_doc/test_links.py::test_link_integrity - AssertionError: Broken ...
FAILED tests_recursive/test_steward_runner.py::TestAT01MissingRunId::test_missing_run_id_fails
FAILED tests_recursive/test_steward_runner.py::TestAT06NoChangeNoCommit::test_no_change_exits_success
FAILED tests_recursive/test_steward_runner.py::TestAT07ChangeWithinAllowedPathsCommits::test_allowed_change_commits
FAILED tests_recursive/test_steward_runner.py::TestAT09DryRunNeverCommits::test_dry_run_skips_commit
FAILED tests_recursive/test_steward_runner.py::TestAT10LogDeterminism::test_logs_are_deterministic
FAILED tests_recursive/test_steward_runner.py::TestAT11TestScopeEnforcement::test_tests_argv_includes_paths
FAILED tests_recursive/test_steward_runner.py::TestAT13FailClosedUnsafePaths::test_unsafe_path_fails[../docs/-path_traversal]
FAILED tests_recursive/test_steward_runner.py::TestAT13FailClosedUnsafePaths::test_unsafe_path_fails[docs/../other/-path_traversal]
FAILED tests_recursive/test_steward_runner.py::TestAT13FailClosedUnsafePaths::test_unsafe_path_fails[docs/*.md-glob_pattern]
FAILED tests_recursive/test_steward_runner.py::TestAT13FailClosedUnsafePaths::test_unsafe_path_fails[docs/?.md-glob_pattern]
FAILED tests_recursive/test_steward_runner.py::TestAT13FailClosedUnsafePaths::test_unsafe_path_fails[C:/temp/-absolute_path_windows]
FAILED tests_recursive/test_steward_runner.py::TestAT13FailClosedUnsafePaths::test_unsafe_path_fails[C:\\temp\\-absolute_path_windows]
FAILED tests_recursive/test_steward_runner.py::TestAT13FailClosedUnsafePaths::test_unsafe_path_fails[/absolute/path/-absolute_path_unix0]
FAILED tests_recursive/test_steward_runner.py::TestAT13FailClosedUnsafePaths::test_unsafe_path_fails[/absolute/path/-absolute_path_unix1]
FAILED tests_recursive/test_steward_runner.py::TestAT13FailClosedUnsafePaths::test_unsafe_path_fails[//server/share/-absolute_path_unc]
FAILED tests_recursive/test_steward_runner.py::TestAT13FailClosedUnsafePaths::test_unsafe_path_fails[docs%2Ffolder-url_encoded_chars]
FAILED tests_recursive/test_steward_runner.py::TestAT14DirtyDuringRun::test_dirty_during_run_rejected
FAILED tests_recursive/test_steward_runner.py::TestAT15LogFieldSorting::test_log_lists_are_sorted
FAILED tests_recursive/test_steward_runner.py::TestAT16DefaultDryRun::test_no_flags_is_dry_run
FAILED tests_recursive/test_steward_runner.py::TestAT17CommitFlagEnables::test_commit_flag_enables
FAILED tests_recursive/test_steward_runner.py::TestAT18ExplicitDryRun::test_explicit_dry_run
= 27 failed, 753 passed, 5 skipped, 1 xfailed, 129 warnings in 125.37s (0:02:05) =
